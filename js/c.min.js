function shuffle(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var _metaStatus,activityIndicatorOff,activityIndicatorOn,allError,animateHoverShadows,animateLoad,bindClickTargets,bindClicks,bindDismissalRemoval,bindPaperMenuButton,browserBeware,bsAlert,buildQuery,byteCount,checkFileVersion,checkLaggedUpdate,checkLocalVersion,checkTaxonNear,clearSearch,dataUriToBlob,dateMonthToString,deEscape,decode64,deepJQuery,delay,doCORSget,doFontExceptions,doLazily,doNothing,domainPlaceholder,downloadDataUriAsBlob,e,encode64,error1,eutheriaFilterHelper,fetchMajorMinorGroups,foo,formatScientificNames,formatSearchResults,getElementHtml,getFilters,getLocation,getMaxZ,getRandomEntry,goTo,insertCORSWorkaround,insertModalImage,interval,isArray,isBlank,isBool,isEmpty,isJson,isNull,isNumber,isNumeric,jsonTo64,lightboxImages,loadJS,mapNewWindows,modalTaxon,openLink,openTab,overlayOff,overlayOn,p$,parseTaxonYear,performSearch,post64,prepURI,randomInt,ref,roundNumber,roundNumberSigfig,safariDialogHelper,safariSearchArgHelper,searchParams,setHistory,setupServiceWorker,showBadSearchErrorMessage,smartUpperCasing,sortResults,startLoad,stopLoad,stopLoadError,toFloat,toInt,toObject,toastStatusMessage,uri,slice=[].slice,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};uri={},uri.o=$.url(),uri.urlString=uri.o.attr("protocol")+"://"+uri.o.attr("host")+uri.o.attr("directory");try{uri.urlString=uri.urlString.replace(/(.*)\/(((&?[a-zA-Z_\-]+=[a-zA-Z_\-\+0-9%=]+)+)\/?)(.*)/gim,"$1/")}catch(a){}uri.query=uri.o.attr("fragment"),domainPlaceholder=uri.o.attr("host").split("."),domainPlaceholder.pop(),uri.domain=null!=(ref=domainPlaceholder[0])?ref:"",_metaStatus={},window.locationData={},locationData.params={enableHighAccuracy:!0},locationData.last=void 0,isBool=function(a){return!0===a||!1===a},isEmpty=function(a){return!a||0===a.length},isBlank=function(a){return!a||/^\s*$/.test(a)},isNull=function(a,b){var c;if(null==b&&(b=!1),"object"==typeof a)try{if(null!=(c=a.length))try{return 0===c}catch(a){}return 0===Object.size}catch(a){}try{if(isEmpty(a)||isBlank(a)||null==a){if(!1!==a&&0!==a)return!0;if(b&&(!1===a||0===a))return!0}}catch(a){return a,!1}try{a=(""+a).toLowerCase()}catch(a){}return"undefined"===a||"null"===a||!(!b||"false"!==a&&"0"!==a)},isJson=function(a){if("object"==typeof a)return!0;try{return JSON.parse(a),!0}catch(a){}return!1},isArray=function(a){var b;try{return b=a.slice(0),b.push("foo"),!0}catch(a){return!1}},isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isNumeric=function(a){return isNumber(a)},toFloat=function(a,b){return null==b&&(b=!1),!isNumber(a)||isNull(a)?b?NaN:0:parseFloat(a)},toInt=function(a,b){return null==b&&(b=!1),!isNumber(a)||isNull(a)?b?NaN:0:parseInt(a)},toObject=function(a){var b,c,d;d={};for(c in a)void 0!==(b=a[c])&&(d[c]=b);return d},String.prototype.toAscii=function(){return this.replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g,"'").replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/[\u2026]/g,"...").replace(/\u02C6/g,"^").replace(/\u2039/g,"").replace(/[\u02DC|\u00A0]/g," ")},String.prototype.toBool=function(){return""+this=="true"},Boolean.prototype.toBool=function(){return""+this=="true"},Number.prototype.toBool=function(){return""+this=="1"},String.prototype.addSlashes=function(){return this.replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)},Array.prototype.containsObject=function(a){try{return"object"==typeof _.find(this,function(b){return _.isEqual(a,b)})}catch(a){return a,console.error("Please load underscore.js before using this."),console.info("https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js")}},Object.toArray=function(a){var b;try{return b=a.slice(0),b.push("foo"),a}catch(a){}return Object.keys(a).map(function(b){return function(b){return a[b]}}())},Object.size=function(a){var b,c,d;if("object"!=typeof a)try{return a.length}catch(a){b=a,console.error("Passed argument isn't an object and doesn't have a .length parameter"),console.warn(b.message)}d=0;for(c in a)a.hasOwnProperty(c)&&d++;return d},Object.doOnSortedKeys=function(a,b){var c,d,e,f,g,h;for(h=Object.keys(a).sort(),g=[],f=0,e=h.length;f<e;f++)d=h[f],c=a[d],g.push(b(c));return g},delay=function(a,b){return setTimeout(b,a)},interval=function(a,b){return setInterval(b,a)},roundNumber=function(a,b){var c;return null==b&&(b=0),c=Math.pow(10,b),Math.round(a*c)/c},roundNumberSigfig=function(a,b){var c,d,e,f,g;return null==b&&(b=0),e=""+roundNumber(a,b),c=e.split("."),1===c.length?e+"."+Array(b+1).join("0"):(g=c.pop(),f=c[0]+".",g.length===b?e:(d=b-g.length,g+=Array(d+1).join("0"),""+f+g))},String.prototype.stripHtml=function(a){var b;return null==a&&(a=!1),b=this,a&&(b=b.replace(/<(\w+)(?:[^"'>]|"[^"]*"|'[^']*')*>(?:((?:.)*?))<\/?\1(?:[^"'>]|"[^"]*"|'[^']*')*>/gm,"")),b=b.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),b=b.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,"")},String.prototype.unescape=function(a){var b,c,d;return null==a&&(a=!1),c=document.createElement("div"),b=function(b){return null!=b&&"string"==typeof b&&(!0!==a?b=escape(b).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"):(b=b.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),b=b.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,"")),c.innerHTML=b,c.innerText?(b=c.innerText,c.innerText=""):(b=c.textContent,c.textContent="")),unescape(b)},d=deEscape(this),b(d)},deEscape=function(a){return a=a.replace(/\&amp;#/gm,"&#"),a=a.replace(/\&quot;/gm,'"'),a=a.replace(/\&quote;/gm,'"'),a=a.replace(/\&#95;/gm,"_"),a=a.replace(/\&#39;/gm,"'"),a=a.replace(/\&#34;/gm,'"'),a=a.replace(/\&#62;/gm,">"),a=a.replace(/\&#60;/gm,"<")},String.prototype.escapeQuotes=function(){var a;return a=this.replace(/"/gm,"&#34;"),a=a.replace(/'/gm,"&#39;")},getElementHtml=function(a){return a.outerHTML},jQuery.fn.outerHTML=function(){var a;return a=$(this).get(0),a.outerHTML},jQuery.fn.outerHtml=function(){return $(this).outerHTML()},jQuery.fn.selectText=function(){var a,b,c=document,d=this[0];c.body.createTextRange?(a=document.body.createTextRange(),a.moveToElementText(d),a.select()):window.getSelection&&(b=window.getSelection(),a=document.createRange(),a.selectNodeContents(d),b.removeAllRanges(),b.addRange(a))},jQuery.fn.exists=function(){return jQuery(this).length>0},jQuery.fn.polymerSelected=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(null==a&&(a=void 0),null==b&&(b="attrForSelected"),null==c&&(c="paper-listbox"),null==d&&(d="paper-item"),null==e&&(e=!0),!$(this).exists())return console.error("Nonexistant element"),!1;if(g=$(this).attr("id"),isNull(g))return console.error("Your parent dropdown (eg, paper-dropdown-menu) must have a unique ID"),!1;h="#"+g+" "+c;try{c===$(this).get(0).tagName.toLowerCase()&&(h=this)}catch(a){}if(!$(h).exists()){c="paper-menu",h="#"+g+" "+c;try{c===$(this).get(0).tagName.toLowerCase()&&(h=this)}catch(a){}if(!$(h).exists()){try{return isNull(p$(this).value)?null:p$(this).value}catch(a){console.error("Can't identify the dropdown selector for this dropdown list '"+g+"'",h,this)}return console.warn("Unable to fetch data for item","#"+g),!1}}if(!0!==b?(f=$(h).attr(b),isNull(f)&&(f=!0)):f=!0,null==a){s=void 0;try{try{s=p$(this).selected}catch(a){}isNull(s)&&(s=p$(h).selected),isNumber(s)&&!isNull(f)?(l=$(this).find(d)[toInt(s)],s=!0!==f?$(l).attr(f):$(l).text()):(console.debug("isNumber(val)",isNumber(s,s)),console.debug("isNull attr",isNull(f,f)))}catch(a){return i=a,console.error("Couldn't find selected: "+i.message),console.warn(i.stack),console.debug("Selector",h),!1}"null"!==s&&null!=s||(s=void 0);try{s=s.trim()}catch(a){}return s}if(q=h,isBool(a)||isNull(a)){if(isBool(a)&&($(this).parent().children().removeAttribute("aria-selected"),$(this).parent().children().removeAttribute("active"),$(this).parent().children().removeClass("iron-selected"),$(this).prop("selected",a),$(this).prop("active",a),$(this).prop("aria-selected",a),!0===a))return $(this).addClass("iron-selected")}else try{if(!0===f){for(o=$(this).find(d),n=0,m=o.length;n<m;n++)if(k=o[n],r=e?$(k).text().toLowerCase().trim():$(k).text(),p=e?a.toLowerCase().trim():a,r===p){j=$(k).index();break}if(isNull(j))return console.error("Unable to find an index for "+d+" with text '"+a+"' (ignore case: "+e+")"),!1;try{p$(q).select(j)}catch(a){i=a,p$(q).selected=j}p$(q).selected!==j&&doNothing()}else try{p$(q).select(a)}catch(b){p$(q).selected=a}return!0}catch(b){return i=b,console.error("Unable to set selected '"+a+"': "+i.message),!1}},jQuery.fn.polymerChecked=function(a){var b;return null==a&&(a=void 0),null!=a?jQuery(this).prop("checked",a):(b=jQuery(this)[0].checked,"null"!==b&&null!=b||(b=void 0),b)},jQuery.fn.isVisible=function(){return"none"!==jQuery(this).css("display")},jQuery.fn.hasChildren=function(){return Object.size(jQuery(this).children())>3},byteCount=function(a){return function(a){return encodeURI(a).split(/%..|./).length-1}}(),randomInt=function(a,b){var c,d,e;return null==a&&(a=0),null==b&&(b=1),e=Math.random(),null==a&&(c=[0,a],a=c[0],b=c[1]),a>b&&(d=[b,a],a=d[0],b=d[1]),Math.floor(e*(b-a+1)+a)},window.debounce_timer=null,Function.prototype.getName=function(){var a;return a=this.name,null==a&&(a=(""+this).substr(0,(""+this).indexOf("(")).replace("function ","")),isNull(a)&&(a=md5(""+this)),a},Function.prototype.debounce=function(){var a,b,c,d,e,f,g,h;g=arguments[0],c=arguments[1],h=arguments[2],a=4<=arguments.length?slice.call(arguments,3):[],null==g&&(g=300),null==c&&(c=!1),null==h&&(h=window.debounce_timer),null==(null!=(f=window.core)?f.debouncers:void 0)&&(null==window.core&&(window.core={}),core.debouncers={});try{e=this.getName()}catch(a){}try{null!=core.debouncers[e]&&(h=core.debouncers[e])}catch(a){}if(d=this,b=function(){if(null!=e&&(clearTimeout(h),delete core.debouncers[e]),!c)return d.apply(d,a)},null!=h)try{clearTimeout(h)}catch(a){a}return c?(d.apply(obj,a),console.debug("Executed "+e+" immediately"),!1):null!=e?core.debouncers[e]=delay(g,function(){return b()}):window.debounce_timer=delay(g,function(){return b()})},loadJS=function(a,b,c){var d,e,f,g;if(null==b&&(b={}),null==c&&(c=!0),$("script[src='"+a+"']").exists()){if("function"==typeof b)try{b()}catch(a){d=a,console.error("Script is already loaded, but there was an error executing the callback function - "+d.message)}return!0}return g=document.createElement("script"),g.setAttribute("src",a),g.setAttribute("async","async"),g.setAttribute("type","text/javascript"),g.src=a,g.async=!0,f=function(){var c;c=g.readyState;try{if(!b.done&&(!c||/loaded|complete/.test(c))&&(b.done=!0,"function"==typeof b))try{return b()}catch(b){return d=b,console.error("Postload callback error for '"+a+"' - "+d.message)}}catch(b){return d=b,console.error("Onload error for '"+a+"' - "+d.message)}},e=function(){console.warn("There may have been a problem loading "+a);try{if(!b.done&&(b.done=!0,"function"==typeof b&&c))try{return b()}catch(a){return d=a,console.error("Post error callback error - "+d.message)}}catch(a){return d=a,console.error("There was an error in the error handler! "+d.message)}},g.setAttribute("onload",f),g.setAttribute("onreadystate",f),g.setAttribute("onerror",e),g.onload=g.onreadystate=f,g.onerror=e,document.getElementsByTagName("head")[0].appendChild(g),!0},String.prototype.toTitleCase=function(){var a,b,c,d,e,f,g,h,i,j,k;for(h=this.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}),e=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"],f=0,a=e.length;f<a;f++)c=e[f],d=RegExp("\\s"+c+"\\s","g"),h=h.replace(d,function(a){return a.toLowerCase()});for(k=["Id","Tv"],g=0,b=k.length;g<b;g++)i=k[g],j=RegExp("\\b"+i+"\\b","g"),h=h.replace(j,i.toUpperCase());return h},smartUpperCasing=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(isNull(a))return"";f=function(a){return a.replace(a,a.toUpperCase())},j=a.replace(/((?=((?!-)[\W\s\r\n]))\s[A-Za-z]|^[A-Za-z])/g,f),k=["a","an","and","at","but","by","for","in","nor","of","on","or","out","so","to","the","up","yet"];try{for(c=0,b=k.length;c<b;c++)l=k[c],g=l.toTitleCase(),e=l.toLowerCase(),d=RegExp(" "+g+" ","g"),j=j.replace(d," "+e+" ")}catch(a){}try{j.match(/([a-zA-Z]+ )*[a-zA-Z]+-([a-z]+)( [a-zA-Z]+)*/m)&&(h=j.replace(/([a-zA-Z]+ )*[a-zA-Z]+-([a-z]+)( [a-zA-Z]+)*/gm,"$2"),i=h.toTitleCase(),j=j.replace(h,i))}catch(a){}return j},mapNewWindows=function(a){return null==a&&(a=!0),$(".newwindow").each(function(){var b,c;return b=$(this).attr("href"),null==b&&(b=$(this).attr("data-href")),c=function(a){return null!=a&&(window.open(a),!1)},$(this).click(function(d){return a&&(d.preventDefault(),d.stopPropagation()),c(b)}),$(this).keypress(function(){return c(b)})})},toastStatusMessage=function(a,b,c,d){var e,f;return null==b&&(b=""),null==c&&(c=3e3),null==d&&(d="#search-status"),!0===window._metaStatus.isToasting?(delay(250,function(){return toastStatusMessage(a,b,c,d)}),!1):(window._metaStatus.isToasting=!0,isNumber(c)||(c=3e3),!1===d.slice(0,1)&&(d="#"+d),$(d).exists()||(e='<paper-toast id="'+d.slice(1)+'" duration="'+c+'"></paper-toast>',$(e).appendTo("body")),$(d).attr("text",a).text(a).addClass(b),(f=function(a){var e;++a;try{return p$(d).show(),delay(c+500,function(){return $(d).empty(),$(d).removeClass(b),$(d).attr("text",""),window._metaStatus.isToasting=!1,!1})}catch(b){return e=b,a<=50?delay(50,function(){return f(a),!1}):(console.error("Couldn't show loader: "+e.message),console.warn(e.stack))}})(0),delay(c,function(){return _metaStatus.isToasting=!1}),!1)},openLink=function(a){return null!=a&&(window.open(a),!1)},openTab=function(a){return openLink(a)},goTo=function(a){return null!=a&&(window.location.href=a,!1)},null==(null!=_metaStatus?_metaStatus.isLoading:void 0)&&(null==_metaStatus&&(window._metaStatus={}),_metaStatus.isLoading=!1,_metaStatus.isToasting=!1),animateLoad=function(a,b){var c,d;null==a&&(a="loader"),null==b&&(b=0),isNumber(a)&&(a="loader"),"#"===a.slice(0,1)?(d=a,a=a.slice(1)):d="#"+a,$(d).removeAttr("hidden"),null==(null!=_metaStatus?_metaStatus.isLoading:void 0)&&(null==_metaStatus&&(_metaStatus={}),_metaStatus.isLoading=!1);try{return _metaStatus.isLoading?b<100?(b++,delay(100,function(){return animateLoad(a,b)}),!1):(console.warn("Loader timed out waiting for load completion"),!1):($(d).exists()?$(d).attr("active",!0):$("body").append('<paper-spinner id="'+a+'" active></paper-spinner'),_metaStatus.isLoading=!0,!1)}catch(a){return c=a,console.warn("Could not animate loader",c.message)}},startLoad=function(a){return null==a&&(a=null),animateLoad(a)},stopLoad=function(a,b,c){var d,e;null==a&&(a="loader"),null==b&&(b=1e3),null==c&&(c=0),"#"===a.slice(0,1)?(e=a,a=a.slice(1)):e="#"+a;try{try{!0!==_metaStatus.isLoading&&p$(e).active&&$(e).isVisible()&&(_metaStatus.isLoading=!0)}catch(a){}return _metaStatus.isLoading?($(e).exists()&&($(e).addClass("good"),function(){return delay(b,function(){try{p$(e).active=!1}catch(a){}return $(e).removeClass("good").attr("active",!1).removeAttr("active"),delay(1,function(){var a,b;return $(e).prop("hidden",!0),null!=("undefined"!=typeof Browsers&&null!==Browsers?Browsers.browser:void 0)?(a=["Spartan","Project Spartan","Edge","Microsoft Edge","MS Edge"],b=Browsers.browser.browser.name,indexOf.call(a,b)>=0||"EdgeHTML"===Browsers.browser.engine.name?($(e).remove(),_metaStatus.isLoading=!1):($(e).removeAttr("hidden"),delay(50,function(){return _metaStatus.isLoading=!1}))):($(e).removeAttr("hidden"),delay(50,function(){return _metaStatus.isLoading=!1}))})})}()),!1):c<100&&(c++,delay(100,function(){return stopLoad(a,b,c)}),!1)}catch(a){return d=a,console.warn("Could not stop load animation",d.message)}},stopLoadError=function(a,b,c,d){var e,f;null==b&&(b="loader"),null==c&&(c=7500),"#"===b.slice(0,1)?(f=b,b=b.slice(1)):f="#"+b;try{return _metaStatus.isLoading?($(f).exists()&&($(f).addClass("bad"),null!=a&&toastStatusMessage(a,"",c),function(){return delay(c,function(){return $(f).removeClass("bad").prop("active",!1).removeAttr("active"),delay(1,function(){var a,b;return $(f).prop("hidden",!0),null!=("undefined"!=typeof Browsers&&null!==Browsers?Browsers.browser:void 0)?(a=["Spartan","Project Spartan","Edge","Microsoft Edge","MS Edge"],b=Browsers.browser.browser.name,indexOf.call(a,b)>=0||"EdgeHTML"===Browsers.browser.engine.name?($(f).remove(),_metaStatus.isLoading=!1):($(f).removeAttr("hidden"),delay(50,function(){return _metaStatus.isLoading=!1}))):($(f).removeAttr("hidden"),delay(50,function(){return _metaStatus.isLoading=!1}))})})}()),!1):d<100&&(d++,delay(100,function(){return stopLoadError(a,b,c,d)}),!1)}catch(a){return e=a,console.warn("Could not stop load error animation",e.message)}},doCORSget=function(a,b,c,d){var e,f,g,h;null==c&&(c=void 0),null==d&&(d=void 0),e=function(){if("function"==typeof d)return d();throw Error("There was an error performing the CORS request")},g={url:a,data:b,type:"get",crossDomain:!0};try{$.ajax(g).done(function(a){if("function"==typeof c)return c(),!1}).fail(function(a,b){return console.warn("Couldn't perform jQuery AJAX CORS. Attempting manually.")})}catch(a){a,console.warn("There was an error using jQuery to perform the CORS request. Attemping manually.")}if(a=a+"?"+b,f=function(a,b){var c;return null==a&&(a="get"),c=new XMLHttpRequest,"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(a,b)):c=null,c},!(h=f("get",a)))throw Error("CORS not supported");return h.onload=function(){var a;return a=h.responseText,"function"==typeof c&&c(a),!1},h.onerror=function(){return console.warn("Couldn't do manual XMLHttp CORS request"),e()},h.send(),!1},deepJQuery=function(a){try{if(!$("html /deep/ "+a).exists())throw"Bad /deep/ selector";return $("html /deep/ "+a)}catch(b){b;try{if(!$("html >>> "+a).exists())throw"Bad >>> selector";return $("html >>> "+a)}catch(b){return b,$(a)}}},p$=function(a){try{return $$(a)[0]}catch(b){try{return $(a).get(0)}catch(b){return d$(a).get(0)}}},window.d$=function(a){return deepJQuery(a)},lightboxImages=function(a,b){var c,d;return null==a&&(a=".lightboximage"),null==b&&(b=!1),d={onStart:function(){return overlayOn()},onEnd:function(){return overlayOff(),activityIndicatorOff()},onLoadStart:function(){return activityIndicatorOn()},onLoadEnd:function(){return activityIndicatorOff()},allowedTypes:"png|jpg|jpeg|gif|bmp|webp",quitOnDocClick:!0,quitOnImgClick:!0},_asm.lightbox={options:d},c=b?d$(a):$(a),loadJS("bower_components/imagelightbox/dist/imagelightbox.min.js",function(){return c.click(function(a){try{return a.preventDefault(),a.stopPropagation(),$(this).imageLightbox(d).startImageLightbox(),console.warn("Event propagation was stopped when clicking on this.")}catch(b){return a=b,console.error("Unable to lightbox this image!")}}).each(function(){var b,c;console.log("Using selectors '"+a+"' / '"+this+"' for lightboximages");try{if(("img"===$(this).prop("tagName").toLowerCase()||"picture"===$(this).prop("tagName").toLowerCase())&&"a"!==$(this).parent().prop("tagName").toLowerCase())return c=$(this).removeClass("lightboximage").prop("outerHTML"),b=function(){switch(!1){case!!isNull($(this).attr("data-layzr-retina")):return $(this).attr("data-layzr-retina");case!!isNull($(this).attr("data-layzr")):return $(this).attr("data-layzr");case!!isNull($(this).attr("data-lightbox-image")):return $(this).attr("data-lightbox-image");case!!isNull($(this).attr("src")):return $(this).attr("src");default:return $(this).find("img").attr("src")}}.call(this),$(this).replaceWith("<a href='"+b+"' data-lightbox='"+b+"' class='lightboximage'>"+c+"</a>"),$("a[href='"+b+"']").imageLightbox(d)}catch(a){return a,console.log("Couldn't parse through the elements")}}),console.info("Lightboxed the following:",c)}),!1},activityIndicatorOn=function(){return $('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},activityIndicatorOff=function(){return $("#imagelightbox-loading").remove(),$("#imagelightbox-overlay").click(function(){return $("#imagelightbox").click()})},overlayOn=function(){return $('<div id="imagelightbox-overlay"></div>').appendTo("body")},overlayOff=function(){return $("#imagelightbox-overlay").remove()},formatScientificNames=function(a){return null==a&&(a=".sciname"),$(".sciname").each(function(){var a;return a="italic"===$(this).css("font-style")?"normal":"italic",$(this).css("font-style",a)})},prepURI=function(a){return a=encodeURIComponent(a),a.replace(/%20/g,"+")},getLocation=function(a){var b,c;return null==a&&(a=void 0),c=function(a,b){return window.locationData.lat=a.coords.latitude,window.locationData.lng=a.coords.longitude,window.locationData.acc=a.coords.accuracy,window.locationData.last=Date.now(),null!=b&&b(window.locationData),!1},b=function(a,b){var c;return c=function(){switch(a.code){case 0:return"There was an error while retrieving your location: "+a.message;case 1:return"The user prevented this page from retrieving a location";case 2:return"The browser was unable to determine your location: "+a.message;case 3:return"The browser timed out retrieving your location."}}(),console.error(c),null!=b&&b(!1),!1},navigator.geolocation?navigator.geolocation.getCurrentPosition(c,b,window.locationData.params):(console.warn("This browser doesn't support geolocation!"),null!=a?a(!1):void 0)},dateMonthToString=function(a){var b,c;b={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};try{c=b[a]}catch(b){c=a}return c},bindClickTargets=function(){return bindClicks(),!1},bindClicks=function(a){return null==a&&(a=".click"),$(a).each(function(){var a,b,c,d;try{if(d=$(this).attr("data-href"),isNull(d)&&null!=(d=$(this).attr("data-url"))&&$(this).attr("data-newtab","true"),!isNull(d)){$(this).unbind();try{d===uri.o.attr("path")&&"paper-tab"===$(this).prop("tagName").toLowerCase()&&$(this).parent().prop("selected",$(this).index())}catch(a){b=a,console.warn("tagname lower case error")}return $(this).click(function(){var a,b,c;return d=$(this).attr("data-href"),isNull(d)&&(d=$(this).attr("data-url")),(null!=(a=$(this).attr("newTab"))?a.toBool():void 0)||(null!=(b=$(this).attr("newtab"))?b.toBool():void 0)||(null!=(c=$(this).attr("data-newtab"))?c.toBool():void 0)?openTab(d):goTo(d)}),d}if(null!=(a=null!=(c=$(this).attr("data-function"))?c:$(this).attr("data-fn")))return $(this).unbind(),$(this).click(function(){try{return window[a]()}catch(c){return b=c,console.error("'"+a+"()' is a bad function - "+b.message)}})}catch(a){return b=a,console.error("There was a problem binding to #"+$(this).attr("id")+" - "+b.message)}}),!1},getMaxZ=function(){var a;return a=function(){return $.map($("body *"),function(a,b){if("static"!==$(a).css("position"))return parseInt($(a).css("z-index")||1)})},Math.max.apply(null,a())},browserBeware=function(){return!1},bsAlert=function(a,b,c,d){var e,f,g,h,i,j;null==b&&(b="warning"),null==c&&(c="body"),null==d&&(d="#bs-alert");try{$(d).exists()?($(d).removeClass("alert-warning alert-info alert-danger alert-success"),$(d).addClass("alert-"+b)):(i='<div class="alert alert-'+b+' alert-dismissable hanging-alert" role="alert" id="'+d.slice(1)+'">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n    <div class="alert-message"></div>\n</div>',j=$("main").exists()?"main":$("article").exists()?"article":c,$(j).prepend(i)),$(d+" .alert-message").html(a)}catch(c){e=document.createElement("div"),e.setAttribute("class","alert alert-"+b+" alert-dismissable hanging-alert"),e.setAttribute("role","alert"),e.setAttribute("id",d.slice(1)),g=document.createElement("button"),g.setAttribute("class","close"),g.setAttribute("data-dismiss","alert"),g.setAttribute("aria-label","Close"),h=document.createElement("span"),h.setAttribute("aria-hidden","true"),h.textContent="&times;",g.appendChild(h),e.appendChild(g),f=document.createElement("div"),f.setAttribute("class","alert-message"),f.textContent=a,e.appendChild(f);try{document.querySelector("#bs-alert").remove()}catch(a){}document.querySelector("body").appendChild(e)}return bindClicks(),mapNewWindows(),!1},animateHoverShadows=function(a,b,c){var d,e;return null==a&&(a="paper-card.card-tile"),null==b&&(b=2),null==c&&(c=4),d=function(){return $(this).attr("elevation",c)},e=function(){return $(this).attr("elevation",b)},$(a).hover(d,e),!1},allError=function(a){return stopLoadError(a),bsAlert(a,"danger"),console.error(a),!1},checkFileVersion=function(a){var b;return null==a&&(a=!1),b=function(){return $.get(uri.urlString+"meta.php","do=get_last_mod","json").done(function(b){var c;return a&&console.log("Forced version check:",b),!!isNumber(b.last_mod)&&(null==_asm.lastMod&&(_asm.lastMod=b.last_mod),b.last_mod>_asm.lastMod?(c='<div id="outdated-warning" class="alert alert-warning alert-dismissible fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>We have page updates!</strong> This page has been updated since you last refreshed. <a class="alert-link" id="refresh-page" style="cursor:pointer">Click here to refresh now</a> and get bugfixes and updates.\n</div>',$("#outdated-warning").exists()||($("body").append(c),$("#refresh-page").click(function(){return document.location.reload(!0)})),console.warn("Your current version is out of date! Please refresh the page.")):a?console.info("Your version is up to date: have "+_asm.lastMod+", got "+b.last_mod):void 0)}).fail(function(){return console.warn("Couldn't check file version!!")}).always(function(){return delay(3e5,function(){return b()})})},!(!a&&null!=_asm.lastMod)&&(b(),!0)},window.checkFileVersion=checkFileVersion,setupServiceWorker=function(){return"serviceworker"in navigator&&navigator.serviceWorker.register("js/serviceWorker.min.js").then(function(a){return console.log("ServiceWorker registered with scope",a.scope)}).catch(function(a){return console.warn("ServiceWorker registration failed:",a)}),!1},foo=function(){return toastStatusMessage("Sorry, this feature is not yet finished"),stopLoad(),!1},doNothing=function(){return null},buildQuery=function(a){var b,c,d,e;d=[];for(b in a)e=a[b],c=b.replace(/[^A-Za-z\-_\[\]]/gim,""),d.push(c+"="+encodeURIComponent(e));return d.join("&")},checkLocalVersion=function(){var a,b,c,d,e,f;if("localhost"===uri.o.attr("host")){for(f=uri.o.attr("directory").split("/"),e=[],b=0,a=f.length;b<a;b++)c=f[b],isNull(c)||e.push(c);d=0===e[0].search("~")?uri.o.attr("protocol")+"://localhost"+e[0]+"/":uri.urlString,$.get(d+"currentVersion").done(function(a){var b,d,e,f;return console.log("Got tag",a),e=a.replace(/v(([0-9]+\.)+[0-9]+)(\-\w+)?/gim,"$1"),e.length>128?(console.error("Problem checking version file"),!1):(f=e.split("."),b={access_token:"7a76691c6beea4d47eaaa6182a53e523c6a16a67"},d="https://api.github.com/repos/tigerhawkvok/asm-mammal-database/releases",$.get(d,buildQuery(b,"json")).done(function(a){var b,d,g,h,i,j,k,l,m,n,o,p;for(console.log("Github API result:",a),j=0,g=a.length;j<g;j++)for(l=a[j],console.log("Checking release",l),m=l.tag_name,o=m.replace(/v(([0-9]+\.)+[0-9]+)(\-\w+)?/gim,"$1"),n=o.split("."),d=0,k=0,h=n.length;k<h;k++){if(c=n[k],p=toInt(c),i=toInt(f[d]),p>i)return console.log("Found mismatched version at",uri.urlString+"/currentVersion"),console.warn("Notice: tag part '"+p+"' > '"+i+"'",m,e),b='<strong>Head\'s-Up:</strong> Your local version is behind the latest application release.\n<br/><br/>\nOpen up your terminal, and in your local directory run:\n<br/><br/>\n<code class="center-block text-center">git pull</code>\n<br/>\nTo get your local version up-to-date.',bsAlert(b),!1;if(p<i)break;++d}return console.debug("Your version is up-to-date"),!1}))})}else doNothing();return!1},jsonTo64=function(a,b){var c,d,e;null==b&&(b=!0);try{e=a.slice(0),e.push("foo"),a=toObject(a)}catch(a){}return d=JSON.stringify(a),c=!0===b?post64(d):encode64(c)},encode64=function(a){try{return Base64.encode(a)}catch(b){return b,console.warn("Bad encode string provided"),a}},decode64=function(a){try{return Base64.decode(a)}catch(b){return b,console.warn("Bad decode string provided"),a}},post64=function(a){var b;return b=encode64(a),encodeURIComponent(b)},dataUriToBlob=function(a,b){var c,d,e,f,g,h,i,j,k,l;g=a.split(",")[1],a.split(";")[1].split(",")[0];try{d=atob(g)}catch(a){d=decodeURIComponent(g)}for(i=d.length,c=new Uint8Array(i),l=a.split(",")[0].split(":")[1].split(";")[0],h=0,k=0,j=c.length;k<j;k++)c[k],c[h]=d.charCodeAt(h),++h;return f={type:l},e=new Blob([c],f),"function"==typeof b&&b(e),e},downloadDataUriAsBlob=function(a){var b,c,d;if(isNull(a))return console.error("Needs a data URI or element selector as an argument!"),!1;try{$(a).exists()&&(c=$(a).attr("href"))}catch(a){}return isNull(c)&&(c=a,a=null),b=dataUriToBlob(c),d=URL.createObjectURL(b),isNull(a)?d:($(a).attr("href",d),!1)};try{$()}catch(error1){e=error1,bsAlert("<strong>You're offline</strong>: We need at least enough data to load a few dependencies. Please put yourself online and try again.","error")}$(function(){var a,b,c,d,f,g,h,i,j,k,l;try{checkLocalVersion(),interval(36e5,function(){return checkLocalVersion()})}catch(a){}formatScientificNames(),bindClicks(),mapNewWindows();try{$("body").tooltip({selector:"[data-toggle='tooltip']"})}catch(a){e=a,console.warn("Tooltips were attempted to be set up, but do not exist")}try{checkAdmin(),!0===("undefined"!=typeof adminParams&&null!==adminParams?adminParams.loadAdminUi:void 0)&&loadJS("js/admin.min.js",function(){return loadAdminUi()})}catch(a){e=a,getLocation(),loadJS("js/admin.min.js",function(){return _asm.inhibitRedirect=!0,verifyLoginCredentials(function(){var a,b,c;if(delete _asm.inhibitRedirect,"species-account.php"===uri.o.attr("file")&&"object"==typeof window.speciesData)try{return c=JSON.stringify(window.speciesData),a="#"+Base64.encode(c),b='<paper-icon-button\n  class="click admin-edit-button"\n  data-href="'+uri.urlString+"admin-page.html"+a+'"\n  icon="icons:create"\n  >\n</paper-icon-button>',$("header p paper-icon-button[icon='icons:home']").before(b),bindClicks(".admin-edit-button")}catch(a){}})}),loadJS("js/jquery.cookie.min.js",function(){return!1})}try{for(k=$("marked-element"),f=0,c=k.length;f<c;f++)g=k[f],h=$(g).find("script").text(),isNull(h)||(p$(g).markdown=h)}catch(a){}browserBeware(),checkFileVersion();try{for(l=$("figcaption .caption-description"),i=0,d=l.length;i<d;i++)a=l[i],b=$(a).text().unescape(),$(a).text(b)}catch(a){}try{return(j=function(a){var b;return $("figure picture").exists()?(b=$("figure picture").width(),isNull(b,!0)?++a>=10?(console.log("Never saw a bigger image width"),!1):(delay(100,function(){return j(a)}),!1):(a>0&&console.warn("Took "+100*a+"ms to reposition image!"),$("figure p.picture-label").css("left","calc(50% - ("+b+"px/2)*.95)"),lightboxImages(),!1)):(console.log("No image on page"),!1)})(0)}catch(a){}}),searchParams={},searchParams.targetApi="api.php",searchParams.targetContainer="#result_container",searchParams.apiPath=uri.urlString+searchParams.targetApi,window._asm={},_asm.affiliateQueryUrl={iucnRedlist:"http://apiv3.iucnredlist.org/api/v3/species/",iucnRedlistCN:"http://apiv3.iucnredlist.org/api/v3/species/common_names/",iNaturalist:"https://www.inaturalist.org/taxa/search"},fetchMajorMinorGroups=function(a,b){var c,d;if(null==a&&(a=null),d=function(){var c,d,e,f,g,h;$("#eutheria-extra").remove(),f='<paper-item data-type="any" selected>All</paper-item>',g=_asm.major;for(e in g)d=g[e],f+='<paper-item data-type="'+e+'">'+d.toTitleCase()+"</paper-item>";if(a?"linnean_family":"simple_linnean_subgroup",
c='<paper-menu-button id="simple-linnean-groups" class="col-xs-6 col-md-4">\n  <paper-button class="dropdown-trigger"><iron-icon icon="icons:filter-list"></iron-icon><span id="filter-what" class="dropdown-label"></span></paper-button>\n  <paper-menu label="Group" data-column="simple_linnean_group" class="cndb-filter dropdown-content" id="linnean" name="type" attrForSelected="data-type" selected="0">\n    '+f+"\n  </paper-menu>\n</paper-menu-button>",$("#simple-linnean-groups").exists()){$("#simple-linnean-groups").replaceWith(c),$("#simple-linnean-groups").on("iron-select",function(){var a;return a=$(p$("#simple-linnean-groups paper-menu").selectedItem).text(),$("#simple-linnean-groups span.dropdown-label").text(a)});try{h=$(p$("#simple-linnean-groups paper-menu").selectedItem).text(),$("#simple-linnean-groups span.dropdown-label").text(h)}catch(a){}}return eutheriaFilterHelper(!0),$("#simple-linnean-groups").exists()&&console.log("Replaced menu items with",f),"function"==typeof b&&b(),!1},"object"==typeof _asm.mammalGroupsBase&&"object"==typeof _asm.major)return isArray(_asm.mammalGroupsBase)||(_asm.mammalGroupsBase=Object.toArray(_asm.mammalGroupsBase)),d(),!0;if(!isBool(a))try{a=null==(c=p$("#use-scientific").checked)||c}catch(b){a=!0}return $.get(searchParams.apiPath,"fetch-groups=true&scientific="+a).done(function(a){return!0===a.status&&(_asm.mammalGroupsBase=Object.toArray(a.minor),_asm.major=a.major,d())}).fail(function(a,b){return console.error("Failed to hit API"),console.warn(a,b),!1}),!1},eutheriaFilterHelper=function(a){if(null==a&&(a=!1),!a){fetchMajorMinorGroups.debounce(50);try{$("#use-scientific").on("iron-change",function(){return delete _asm.mammalGroupsBase,fetchMajorMinorGroups.debounce(50)})}catch(a){}}$("#linnean").on("iron-select",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;if("eutheria"===$(p$("#linnean").selectedItem).attr("data-type")){for(h=[],k=_asm.mammalGroupsBase,g=0,e=k.length;g<e;g++)d=k[g],h.push(d.toLowerCase());for(h.sort(),i="",j=0,f=h.length;j<f;j++)b=h[j],c='<paper-item data-type="'+b+'">\n  '+b.toTitleCase()+"\n</paper-item>",i+=c;if(!isBool(m))try{m=null==(l=p$("#use-scientific").checked)||l}catch(a){m=!0}return a=m?"linnean_order":"simple_linnean_subgroup",c='<div id="eutheria-extra"  class="col-xs-6 col-md-4">\n    <label for="type" class="sr-only">Eutheria Filter</label>\n    <div class="row">\n    <paper-menu-button class="col-xs-12" id="eutheria-subfilter">\n      <paper-button class="dropdown-trigger"><iron-icon icon="icons:filter-list"></iron-icon><span id="filter-what" class="dropdown-label"></span></paper-button>\n      <paper-menu label="Group" data-column="'+a+'" class="cndb-filter dropdown-content" id="linnean-eutheria" name="type" attrForSelected="data-type" selected="0">\n        <paper-item data-type="any" selected>All</paper-item>\n        '+i+"\n        \x3c!-- As per flag 4 in readme --\x3e\n      </paper-menu>\n    </paper-menu-button>\n    </div>\n  </div>",$("#simple-linnean-groups").after(c),$("#eutheria-subfilter").on("iron-select",function(){var a;return a=$(p$("#eutheria-subfilter paper-menu").selectedItem).attr("data-type"),$("#eutheria-subfilter span.dropdown-label").text(a)}),n=$(p$("#eutheria-subfilter paper-menu").selectedItem).attr("data-type"),$("#eutheria-subfilter span.dropdown-label").text(n)}return $("#eutheria-extra").remove()});try{doLazily()}catch(a){}return!1},checkLaggedUpdate=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o;if(f=["common_name","species_authority"],n=Date.now(),!0===a.do_client_update){h=g=0,c=!1;try{l=a.result;for(d in l){for(o=l[d],m=!0,k=0,j=f.length;k<j;k++)if(i=f[k],isNull(o[i])){m=!1;break}m||(++h,b="missing=true&genus="+o.genus+"&species="+o.species,$.get(searchParams.targetApi,b,"json").done(function(a){var b,c,d;if(++g,!a.did_update)return!1;console.log("Update for "+a.canonical_sciname,a),c=$(".cndb-result-entry[data-taxon='"+a.genus+"+"+a.species+"']");for(b in a)d=a[b],$(c).find("."+b).exists()&&!isNull(d)?isNull($(c).find("."+b).text())&&(console.log("Set "+b+" text of "+a.canonical_sciname+" to "+d),$(c).find("."+b).text(d)):$(c).find("."+b).exists()&&isNull(d)&&console.warn("Couldn't update "+b+" - got an empty IUCN result");return!1}).fail(function(a,c){return console.warn("Couldn't update "+o.canonical_sciname,a,c),console.warn(searchParams.targetApi+"?"+b),!1}).always(function(){var a;if(g===h&&c)return a=Date.now()-n,console.log("Finished async IUCN taxa check in "+a+"ms")}))}c=!0}catch(a){e=a,console.warn("Couldn't do client update -- "+e.message),console.warn(e.stack)}}return!1},performSearch=function(a){var b,c,d;if(null==a&&(a=void 0),null==a){if(d=$("#search").val(),d,d=d.toLowerCase(),c=getFilters(),(isNull(d)||null==d)&&isNull(c))return $("#search-status").attr("text","Please enter a search term."),$("#search-status")[0].show(),!1;$("#search").blur(),d=d.replace(/\./g,""),d=prepURI(d),$("#loose").polymerChecked()&&(d+="&loose=true"),$("#fuzzy").polymerChecked()&&(d+="&fuzzy=true"),isNull(c)||(d=d+"&filter="+c),b="q="+d}else!0===a?(b="q=","(all items)"):(b="q="+a,a.split("&")[0]);return!("#"===d||isNull(d)&&isNull(b)||"q="===b&&!0!==a)&&(animateLoad(),console.log("Got search value "+d+", hitting",searchParams.apiPath+"?"+b),$.get(searchParams.targetApi,b,"json").done(function(a){return 0===toInt(a.count)?(console.error("No search results: Got search value "+d+", from hitting",searchParams.apiPath+"?"+b),showBadSearchErrorMessage.debounce(null,null,null,a),clearSearch(!0),!1):!0===a.status?(console.log("Server response:",a),formatSearchResults(a,void 0,function(){return checkLaggedUpdate(a)}),!1):(clearSearch(!0),$("#search-status").attr("text",a.human_error),$("#search-status")[0].show(),console.error(a.error),console.warn(a),stopLoadError())}).fail(function(a,b){return console.error("There was an error performing the search"),console.warn(a,b,a.statusText),b=a.status+" - "+a.statusText,$("#search-status").attr("text","Couldn't execute the search - "+b),$("#search-status")[0].show(),stopLoadError()}).always(function(){var a;return a=Base64.encodeURI(d),null!=d&&setHistory(uri.urlString+"#"+a),!1}))},getFilters=function(a,b){var c,d;if(null==a&&(a=".cndb-filter"),null==b&&(b="AND"),c={},$(a).each(function(){var a,b;if(null==(a=$(this).attr("data-column")))return!0;try{b=$(this).polymerSelected()}catch(a){return!0}return"any"===b||"all"===b||"*"===b||(!(!isNull(b)&&!1!==b||(b=$(this).val(),!isNull(b)))||(c[a]=b.toLowerCase()))}),0===Object.size(c))return"";try{return c.BOOLEAN_TYPE=b,d=JSON.stringify(c),Base64.encodeURI(d)}catch(a){return e=a,!1}},formatSearchResults=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q;return null==b&&(b=searchParams.targetContainer),o=Date.now(),i=0,$("#result-header-container").removeAttr("hidden"),g=a.result,searchParams.result=g,[],p="cndb-result-list",l="<table id='"+p+"' class='table table-striped table-hover col-md-12'>\n\t<tr class='cndb-row-headers'>",k="</table>",q=a.count,q>150?toastStatusMessage("We found "+a.count+" results, please hang on a moment while we render them...","",5e3):console.log("Not notifying of render delay, only showing "+q+" items"),f=null,d=0,h=["id","minor_type","notes","major_type","taxon_author","taxon_credit","image_license","image_credit","taxon_credit_date","parens_auth_genus","parens_auth_species","is_alien","internal_id","source","deprecated_scientific","canonical_sciname","simple_linnean_group","iucn","dwc","entry","common_name_source","image_caption"],j=0,m=delay(7500,function(){return stopLoadError("There was a problem parsing the search results."),console.error("Couldn't finish parsing the results! Expecting "+q+" elements, timed out on "+j+"."),console.warn(g),!1}),n=["common_name","genus","species"],delay(5,function(){var q,r,s,t,u,v,w,x,y,z,A,B,C,D;r=[];for(t in g){B=g[t],q=!0;for(u in B)D=B[u],indexOf.call(r,u)>=0||(isNull(D)?q=!1:r.push(u));if(q)break}indexOf.call(r,"subspecies")>=0&&n.push("subspecies"),z=g[0];for(u in z)D=z[u],indexOf.call(n,u)<0&&indexOf.call(h,u)<0&&indexOf.call(r,u)>=0&&n.push(u);y=g,g={};for(t in y)for(B=y[t],g[t]={},x=0,w=n.length;x<w;x++)v=n[x],g[t][v]=B[v];return C=0,s=Object.toArray(g),(A=function(g,h,n){var q,r,s,v,w,x,y,z,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;y="",t=0,I=null,Q=!1,isNumber(n)||(n=100),v=g.length<=n;try{L={action:"render-row",data:g,chunk:n,firstIteration:h},R=new Worker("js/serviceWorker.js"),console.info("Rendering list off-thread"),R.addEventListener("message",function(a){return console.info("Got message back from service worker",a.data),Q=!0,y=a.data.html,I=a.data.nextChunk,a.data.renderChunk,t=a.data.loops,H()}),R.postMessage(L)}catch(a){for(console.log("Starting loop with i = "+t+", renderChunk = "+n+", data length = "+g.length,h,v),K=0,G=g.length;K<G;K++){if(B=g[K],++C,j=t,0===toInt(t)&&h){E=0,l+="\n\x3c!-- Table Headers - "+Object.size(B)+" entries --\x3e";for(u in B)D=B[u],++C,J=u.replace(/_/g," "),J=function(){switch(J){case"simple linnean subgroup":return"Group";case"major subtype":return"Clade";default:return J}}(),l+="\n\t\t<th class='text-center'>"+J+"</th>",d++,E++;l+="\n\t</tr>",l+="\n\x3c!-- End Table Headers --\x3e",console.log("Got "+d+" display columns."),q=roundNumber(12/d,0),f="col-md-"+q,w=l+k,y=l,$(b).html(w)}P=B.genus+"+"+B.species,isNull(B.subspecies)||(P=P+"+"+B.subspecies),M="msadb-row"+t,z="\n\t<tr id='"+M+"' class='cndb-result-entry' data-taxon=\""+P+'" data-genus="'+B.genus+'" data-species="'+B.species+'">';for(u in B){if(r=B[u],++C,"authority_year"===u)if(isNull(r))s=r;else{try{s=JSON.parse(r)}catch(a){e=a;try{console.warn("There was an error parsing authority_year='"+r+"', attempting to fix - ",e.message),O=r.split(":"),S=O[1].slice(O[1].search('"')+1,-2),S=S.replace(/"/g,"'"),O[1]='"'+S+'"}',r=O.join(":"),s=JSON.parse(r)}catch(a){e=a,console.error("There was an error parsing '"+r+"'",e.message),s=r}}try{x=Object.keys(s)[0],N=s[x],toInt(B.parens_auth_genus).toBool()&&(x="("+x+")"),toInt(B.parens_auth_species).toBool()&&(N="("+N+")"),r="G: "+x+"<br/>S: "+N}catch(a){}}"image"===u&&(r=isNull(r)?"<paper-icon-button icon='launch' data-href='"+_asm.affiliateQueryUrl.mammalPhotos+"?rel-taxon=contains&where-taxon="+P+"' class='newwindow calphoto click' data-taxon=\""+P+'"></paper-icon-button>':"<paper-icon-button icon='image:image' data-lightbox='"+uri.urlString+r+"' class='lightboximage'></paper-icon-button>"),F="genus"!==u&&"species"!==u&&"subspecies"!==u?u+" text-center":u,"genus_authority"===u||"species_authority"===u?F+=" authority":"common_name"===u&&(r=smartUpperCasing(r),F+=" no-cap"),z+="\n\t\t<td id='"+u+"-"+t+"' class='"+F+" "+f+"'>"+r+"</td>"}if(z+="\n\t</tr>",y+=z,++t>=n)break}console.log("Ended data loop with i = "+t+", renderChunk = "+n),H()}return H=function(){var d,e;if(h?(y+=k,$(b).html(y),$("#result-count").text(" - "+a.count+" entries"),"space_common_fallback"!==a.method||$("#space-fallback-info").exists()?$("#space-fallback-info").exists()&&$("#space-fallback-info").prop("hidden",!0):(e='<div id="space-fallback-info" class="alert alert-info alert-dismissible center-block fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>Don\'t see what you want?</strong> We might use a slightly different name. Try <a href="" class="alert-link" id="do-instant-fuzzy">checking the "fuzzy" toggle and searching again</a>, or use a shorter search term.\n</div>',$("#result_container").before(e),$("#do-instant-fuzzy").click(function(a){var b;return a.preventDefault(),b=function(){return $("#fuzzy").get(0).checked=!0,performSearch()},b.debounce()}))):$("table#"+p+" tbody").append(y),v||(i=Date.now()-o,null==I&&(I=g.slice(t)),console.log("Chunk rendered at "+i+"ms, next bit with slice @ "+t+":",I),0!==I.length?(d=Q?25:250,delay(d,function(){return A(I,!1,n)})):v=!0),v&&(i=Date.now()-o,console.log("Finished rendering list in "+i+"ms"),console.debug("Executed "+C+" loops"),i>3e3&&!Q&&console.warn("Warning: Took greater than 3 seconds to render!"),stopLoad(),delay(250,function(){return stopLoad()}),"function"==typeof c))try{c()}catch(a){}return clearTimeout(m),mapNewWindows(),lightboxImages(),$(".cndb-result-entry").unbind().click(function(){var a;return a="genus="+$(this).attr("data-genus")+"&species="+$(this).attr("data-species"),goTo("species-account.php?"+a)}),doFontExceptions()}})(s,!0,100)}),!1},parseTaxonYear=function(a,b){var c,d,f,g,h;null==b&&(b=!0);try{c=JSON.parse(a)}catch(d){e=d,console.warn("There was an error parsing '"+a+"', attempting to fix - ",e.message);try{g=a.split(":"),h=g[1].slice(g[1].search('"')+1,-2),h=h.replace(/"/g,"'"),g[1]='"'+h+'"}',a=g.join(":");try{c=JSON.parse(a)}catch(c){return e=c,!b&&a}}catch(c){return e=c,!b&&a}}return d=Object.keys(c)[0],f=c[d],h={},h.genus=d,h.species=f,h},checkTaxonNear=function(a,b,c){var d,e,f,g,h,i;return null==a&&(a=void 0),null==b&&(b=void 0),null==c&&(c="#near-me-container"),null==a?(console.warn("Please specify a taxon."),!1):(null==locationData.last&&getLocation(),g=(Date.now()-locationData.last)/1e3,g>900&&getLocation(),d="https://www.inaturalist.org/places.json",e="taxon="+a+"&latitude="+locationData.lat+"&longitude="+locationData.lng+"&place_type=county",h="",f="",i="",$.get(d,e,"json").done(function(a){return Object.size(a)>0?(h="communication:location-on",f="good-location",i="This species occurs in your county"):(h="communication:location-off",f="bad-location",i="This species does not occur in your county")}).fail(function(a,b){return f="bad-location",h="warning",i="We couldn't determine your location"}).always(function(){var a;if(a='<div class="tooltip fade top in right manual-placement-tooltip" role="tooltip" style="top: 6.5em; left: 4em; right:initial; display:none" id="manual-location-tooltip">\n  <div class="tooltip-arrow" style="top:50%;left:5px"></div>\n  <div class="tooltip-inner">'+i+"</div>\n</div>",d$(c).html("<iron-icon icon='"+h+"' class='small-icon "+f+" near-me' data-toggle='tooltip' id='near-me-icon'></iron-icon>"),$(c).after(a).mouseenter(function(){return d$("#manual-location-tooltip").css("display","block"),!1}).mouseleave(function(){return d$("#manual-location-tooltip").css("display","none"),!1}),null!=b)return b()}),!1)},insertModalImage=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o;if(null==a&&(a=_asm.taxonImage),null==b&&(b=_asm.activeTaxon),null==c&&(c=void 0),null==b)return console.error("Tried to insert a modal image, but no taxon was provided!"),!1;if("object"!=typeof b)return console.error("Invalid taxon data type (expecting object), got "+typeof b),o={taxon:b,imageUrl:i,defaultTaxon:_asm.activeTaxon,defaultImage:_asm.taxonImage},console.warn(o),!1;if(l=function(a,b,d){var f,g,h,i,j,k,l;null==d&&(d="calphoto"),l=a.thumbUri,i=a.imageUri,j="function"==typeof a.imageLinkUri?a.imageLinkUri(a.imageUri):void 0,h=a.imageLicense,g=a.imageCredit,f='<div class="modal-img-container">\n  <a href="'+i+'" class="'+d+'-img-anchor center-block text-center">\n    <img src="'+l+'"\n      data-href="'+j+'"\n      class="'+d+'-img-thumb"\n      data-taxon="'+b+'" />\n  </a>\n  <p class="small text-muted text-center">\n    Image by '+g+" under "+h+"\n  </p>\n</div>",d$("#meta-taxon-info").before(f),(k=function(a){try{return d$("#modal-taxon").get(0).fit(),delay(250,function(){return d$("#modal-taxon").get(0).fit(),delay(750,function(){return d$("#modal-taxon").get(0).fit()})})}catch(b){return e=b,a<10?(a++,delay(100,function(){return k(a)})):console.warn("Couldn't execute fit!")}})(0);try{lightboxImages("."+d+"-img-anchor",!0)}catch(a){e=a,console.error("Error lightboxing images")}return"function"==typeof c&&c(),!1},m=[b.genus,b.species],null!=b.subspecies&&m.push(b.subspecies),n=m.join("+"),null!=a.imageUri)return"string"==typeof a&&(i=a,a={},a.imageUri=i),j=a.imageUri.split("."),g=j.pop(),k=j.join("."),a.thumbUri=""+uri.urlString+k+"-thumb."+g,a.imageUri=""+uri.urlString+k+"."+g,l(a,n,"asmimg"),!1;d="getthumbinfo=1&num=all&cconly=1&taxon="+n+"&format=xml",f=function(b){var c,f;f=xmlToJSON.parseString(b),window.testData=f;try{c=f.calphotos[0]}catch(a){e=a,c=void 0}if(null==c)return!1;a={};try{if(a.thumbUri=c.thumb_url[0]._text,null==a.thumbUri)return console.warn("CalPhotos didn't return any valid images for this search!"),!1;a.imageUri=c.enlarge_jpeg_url[0]._text,a.imageLinkUri=c.enlarge_url[0]._text,a.imageLicense=c.license[0]._text,a.imageCredit=c.copyright[0]._text+" (via CalPhotos)"}catch(a){return e=a,console.warn("CalPhotos didn't return any valid images for this search!",_asm.affiliateQueryUrl.calPhotos+"?"+d),!1}return l(a,n),!1},h=function(a,b){return insertCORSWorkaround(),console.error("Couldn't load a CalPhotos image to insert!"),!1};try{doCORSget(_asm.affiliateQueryUrl.calPhotos,d,f,h)}catch(a){e=a,console.error(e.message)}return!1},modalTaxon=function(a){var b;return null==a&&(a=void 0),null==a?($(".cndb-result-entry").click(function(){return modalTaxon($(this).attr("data-taxon"))}),!1):(animateLoad(),$("#modal-taxon").exists()||(b='<paper-dialog modal id=\'modal-taxon\' entry-animation="scale-up-animation" exit-animation="scale-down-animation">\n  <h2 id="modal-heading"></h2>\n  <paper-dialog-scrollable id=\'modal-taxon-content\'></paper-dialog-scrollable>\n  <div class="buttons">\n    <paper-button id=\'modal-inat-linkout\'>iNaturalist</paper-button>\n    <paper-button id=\'modal-calphotos-linkout\' class="hidden-xs">CalPhotos</paper-button>\n    <paper-button id=\'modal-alt-linkout\' class="hidden-xs"></paper-button>\n    <paper-button dialog-dismiss autofocus>Close</paper-button>\n  </div>\n</paper-dialog>',$("body").append(b)),$.get(searchParams.targetApi,"q="+a,"json").done(function(c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(null==(f=c.result[0]))return toastStatusMessage("There was an error fetching the entry details. Please try again later."),stopLoadError(),!1;if(r=parseTaxonYear(f.authority_year),s="",!1!==r&&(h="<span class='genus_authority authority'>"+f.genus_authority+"</span> "+r.genus,o="<span class='species_authority authority'>"+f.species_authority+"</span> "+r.species,toInt(f.parens_auth_genus).toBool()&&(h="("+h+")"),toInt(f.parens_auth_species).toBool()&&(o="("+o+")"),s="<div id=\"is-alien-container\" class=\"tooltip-container\"></div>\n<div id='near-me-container' data-toggle='tooltip' data-placement='top' title='' class='near-me tooltip-container'></div>\n<p>\n  <span class='genus'>"+f.genus+"</span>,\n  "+h+";\n  <span class='species'>"+f.species+"</span>,\n  "+o+"\n</p>"),g="",!isNull(f.deprecated_scientific)){g="<p>Deprecated names: ";try{n=JSON.parse(f.deprecated_scientific),j=0,$.each(n,function(a,b){if(j++,1!==j&&(g+="; "),g+="<span class='sciname'>"+a+"</span>, "+b,j===Object.size(n))return g+="</p>"})}catch(a){e=a,g="",console.error("There were deprecated scientific names, but the JSON was malformed.")}}k="",isNull(f.minor_type)||(k=" <iron-icon icon='arrow-forward'></iron-icon> <span id='taxon-minor-type'>"+f.minor_type+"</span>"),isNull(f.notes)?(f.notes="Sorry, we have no notes on this taxon yet.",f.taxon_credit=""):isNull(f.taxon_credit)||"null"===f.taxon_credit?f.taxon_credit="This taxon information is uncredited.":(q=isNull(f.taxon_credit_date)||"null"===f.taxon_credit_date?"":" ("+f.taxon_credit_date+")",f.taxon_credit="Taxon information by "+f.taxon_credit+"."+q);try{l=markdown.toHTML(f.notes)}catch(a){e=a,l=f.notes,console.warn("Couldn't parse markdown!! "+e.message)}l=l.replace(/\&amp;(([a-z]+|[0-9]+);)/gm,"&$1"),d=isNull(f.major_common_type)?"":" (<span id='taxon-common-type'>"+f.major_common_type+"</span>) ",b="<div id='meta-taxon-info'>\n  "+s+"\n  <p>\n    English name: <span id='taxon-common-name' class='common_name no-cap'>"+smartUpperCasing(f.common_name)+"</span>\n  </p>\n  <p>\n    Type: <span id='taxon-type' class=\"major_type\">"+f.major_type+"</span>\n    "+d+"\n    <iron-icon icon='arrow-forward'></iron-icon>\n    <span id='taxon-subtype' class=\"major_subtype\">"+f.major_subtype+"</span>"+k+"\n  </p>\n  "+g+"\n</div>\n<h3>Taxon Notes</h3>\n<p id='taxon-notes'>"+l+'</p>\n<p class="text-right small text-muted">'+f.taxon_credit+"</p>",$("#modal-taxon-content").html(b),$("#modal-inat-linkout").unbind().click(function(){return openTab(_asm.affiliateQueryUrl.iNaturalist+"?q="+a)}),$("#modal-calphotos-linkout").unbind().click(function(){return openTab(_asm.affiliateQueryUrl.calPhotos+"?rel-taxon=contains&where-taxon="+a)}),m=null,p=a.split("+"),_asm.activeTaxon={genus:p[0],species:p[1],subspecies:p[2]},null!=m?($("#modal-alt-linkout").replaceWith(button),$("#modal-alt-linkout").click(function(){return openTab(m)})):$("#modal-alt-linkout").addClass("hidden").unbind(),formatScientificNames(),doFontExceptions(),i=a.charAt(0).toUpperCase()+a.slice(1),i=i.replace(/\+/g," "),d$("#modal-heading").text(i),isNull(f.image)&&(f.image=void 0),_asm.taxonImage={imageUri:f.image,imageCredit:f.image_credit,imageLicense:f.image_license};try{insertModalImage()}catch(a){e=a,console.info("Unable to insert modal image! ")}return checkTaxonNear(a,function(){var a;return stopLoad(),a=d$("#modal-taxon")[0],d$("#modal-taxon").on("iron-overlay-opened",function(){return a.fit(),a.scrollTop=0,toFloat($(a).css("top").slice(0,-2))>$(window).height()&&$(a).css("top","12.5vh"),delay(250,function(){return a.fit()})}),a.sizingTarget=d$("#modal-taxon-content")[0],safariDialogHelper("#modal-taxon")}),bindDismissalRemoval()}).fail(function(a,b){return stopLoadError()}),!1)},bindDismissalRemoval=function(){return $("[dialog-dismiss]").unbind().click(function(){return $(this).parents("paper-dialog").remove()})},doFontExceptions=function(){var a,b;return a=["de","and"],b=function(b){return $.each(a,function(a,c){var d;if(d=" "+c+" ",null!=b)return b=b.replace(d," <span class='force-lower'>"+c+"</span> ")}),b},d$(".authority").each(function(){var a;if(a=$(this).text(),!isNull(a))return $(this).html(b(a))}),!1},sortResults=function(a){return searchParams.result},setHistory=function(a,b,c){return null==a&&(a="#"),null==b&&(b=null),null==c&&(c=null),history.pushState(b,c,a),uri.query=$.url(a).attr("fragment"),!1},clearSearch=function(a){var b;return null==a&&(a=!1),$("#result-count").text(""),b='<div class="bs-callout bs-callout-info center-block col-xs-12 col-sm-8 col-md-5">\n  Search for a common or scientific name above to begin, eg, "Brown Bear" or "<span class="sciname">Ursus arctos</span>"\n</div>',$("#result_container").html(b),$("#result-header-container").attr("hidden","hidden"),!0!==a&&(setHistory(),$(".cndb-filter").attr("value",""),$("#collapse-advanced").collapse("hide"),$("#search").attr("value",""),$("#linnean").polymerSelected("any"),formatScientificNames(),!1)},safariDialogHelper=function(a,b,c){var d,f;if(null==a&&(a="#download-chooser"),null==b&&(b=0),"function"!=typeof c&&(c=function(){return bindDismissalRemoval()}),!(b<10))return stopLoadError("Unable to show dialog. Please try again.");try{try{p$(a).open()}catch(b){d$(a).get(0).open()}return"function"==typeof c&&c(),stopLoad()}catch(g){return e=g,f=b+1,d=250,delay(d,function(){return console.warn("Trying again to display dialog after "+f*d+"ms"),console.debug("Error caught: "+e.message),console.debug(e.stack),safariDialogHelper(a,f,c)})}},safariSearchArgHelper=function(a,b){var c,d;return null==b&&(b=!1),c=null!=a?a:$("#search").val(),d=!1,-1!==c.search(/\+/)&&(d=!0,c=c.replace(/\+/g," ").trim(),delay(100,function(){return safariSearchArgHelper()})),(d||null!=a)&&($("#search").attr("value",c),b||delay(5e3,function(){return safariSearchArgHelper(void 0,!0)})),!1},insertCORSWorkaround=function(){var a,b,c;if(null==_asm.hasShownWorkaround&&(_asm.hasShownWorkaround=!1),_asm.hasShownWorkaround)return!1;try{b=new WhichBrowser}catch(a){return e=a,!1}return b.isType("mobile")?(_asm.hasShownWorkaround=!0,!1):(a=function(){switch(b.browser.name){case"Chrome":return"Install the extension \"<a class='alert-link' href='https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi?utm_source=chrome-app-launcher-info-dialog'>Allow-Control-Allow-Origin: *</a>\", activate it on this domain, and you'll see them in your popups!";case"Firefox":return"Follow the instructions <a class='alert-link' href='http://www-jo.se/f.pfleger/forcecors-workaround'>for this ForceCORS add-on</a>, or try Chrome for a simpler extension. Once you've done so, you'll see photos in your popups!";case"Internet Explorer":return"Follow these <a class='alert-link' href='http://stackoverflow.com/a/20947828'>StackOverflow instructions</a> while on this site, and you'll see them in your popups!";default:return""}}(),c='<div class="alert alert-info alert-dismissible center-block fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>Want CalPhotos images in your species dialogs?</strong> '+a+"\n  We're working with CalPhotos to enable this natively, but it's a server change on their side.\n</div>",$("#result_container").before(c),$(".alert").alert(),_asm.hasShownWorkaround=!0,!1)},showBadSearchErrorMessage=function(a){var b,c,d,e;try{d=a.query.replace(/\+/g," ")}catch(a){d=$("#search").val()}try{!0===a.status?!0===a.query_params.filter.had_filter?(b="",c=0,$.each(a.query_params.filter.filter_params,function(d,e){if("BOOLEAN_TYPE"!==d)return 0!==c&&(b=filter_text+" "+a.filter.filter_params.BOOLEAN_TYPE),isNumber(toInt(e,!0))&&(e=1===toInt(e)?"true":"false"),b=b+" "+d.replace(/_/g," ")+" is "+e}),e='"'+d+'" where '+b+" returned no results."):e='"'+d+'" returned no results.':e=a.human_error}catch(a){e="Sorry, there was a problem with your search"}return stopLoadError(e)},bindPaperMenuButton=function(a,b){return null==a&&(a="paper-menu-button"),null==b&&(b=!0),!1},getRandomEntry=function(){var a;return startLoad(),a={random:!0},$.get(searchParams.apiPath,buildQuery(a,"json")).done(function(a){var b,c;return(isNull(a.genus)||isNull(a.species))&&stopLoadError("Unable to fetch random entry"),b={genus:a.genus,species:a.species},isNull(a.subspecies)||(b.subspecies=a.subspecies),c=uri.urlString+"species-account.php?"+buildQuery(b),console.log("About to go to",c),goTo(c),stopLoad()}).fail(function(){return stopLoadError("Unable to fetch random entry")}),!1},window.getRandomEntry=getRandomEntry,doLazily=function(){return loadJS(uri.urlString+"js/download.min.js"),!1},$(function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r;if(b="****************************************************************************\nHello developer!\nIf you're looking for hints on our API information, this site is open-source\nand released under the GPL. Just click on the GitHub link on the bottom of\nthe page, or check out LINK_TO_ORG_REPO\n****************************************************************************",console.log(b),_asm.polymerReady=!1,h=["admin-login.php","admin-page.html","admin-page.php"],m=uri.o.attr("file"),indexOf.call(h,m)>=0){try{(o=function(){var a;try{if(null!=("undefined"!=typeof Polymer&&null!==Polymer&&null!=(a=Polymer.Base)?a.$$:void 0))return Polymer.Base.ready(function(){return _asm.polymerReady=!0}),delay(250,function(){return _asm.polymerReady=!0});throw{message:"POLYMER_NOT_READY"}}catch(a){return delay(100,function(){return o})}})()}catch(a){}return!1}if(animateLoad(),window.addEventListener("popstate",function(a){var b,c;uri.query=$.url().attr("fragment");try{b=Base64.decode(uri.query)}catch(a){a,b=""}return performSearch.debounce(50,null,null,b),c=b.split("&")[0],$("#search").attr("value",c)}),$("#do-reset-search").click(function(){return clearSearch()}),$("#search_form").submit(function(a){return a.preventDefault(),performSearch.debounce(50)}),$("#collapse-advanced").on("shown.bs.collapse",function(){return $("#collapse-icon").attr("icon","icons:unfold-less")}),$("#collapse-advanced").on("hidden.bs.collapse",function(){return $("#collapse-icon").attr("icon","icons:unfold-more")}),$("#search_form").keypress(function(a){if(13===a.which)return performSearch.debounce(50)}),$("#do-search").click(function(){return performSearch.debounce(50)}),$("#do-search-all").click(function(){return performSearch.debounce(50,null,null,!0)}),$("#linnean").on("iron-select",function(){if(!isNull($("#search").val()))return performSearch.debounce()}),eutheriaFilterHelper(),bindPaperMenuButton(),isNull(uri.query)){i="";try{(o=function(){var a;try{if(null!=("undefined"!=typeof Polymer&&null!==Polymer&&null!=(a=Polymer.Base)?a.$$:void 0))return Polymer.Base.ready(function(){return _asm.polymerReady=!0}),delay(250,function(){return _asm.polymerReady=!0});throw{message:"POLYMER_NOT_READY"}}catch(a){return delay(100,function(){return o})}})()}catch(a){}}else try{i=Base64.decode(uri.query),l=$.url(searchParams.apiPath+"?q="+i);try{j=l.param("loose").toBool()}catch(a){e=a,j=!1}try{g=l.param("fuzzy").toBool()}catch(a){e=a,g=!1}q=i.split("&")[0],safariSearchArgHelper(q),(f=function(){var a;if(null!=("undefined"!=typeof Polymer&&null!==Polymer&&null!=(a=Polymer.Base)?a.$$:void 0)&&!isNull(Polymer.Base.$$("#loose")))return _asm.polymerReady=!0,delay(250,function(){if(j&&d$("#loose").attr("checked","checked"),g)return d$("#fuzzy").attr("checked","checked")}),!1;if(null==_asm.stateIter&&(_asm.stateIter=0),++_asm.stateIter>30)return console.warn("Couldn't attach Polymer.Base.ready"),!1;try{return Polymer.Base.ready(function(){return _asm.polymerReady=!0,delay(250,function(){return console.info("Doing a late Polymer.Base.ready call"),j&&d$("#loose").attr("checked","checked"),g&&d$("#fuzzy").attr("checked","checked"),safariSearchArgHelper(),eutheriaFilterHelper()})})}catch(a){return delay(250,function(){return f()})}})();try{c=l.param("filter"),d=JSON.parse(Base64.decode(c)),k=!1,p=["simple-linnean-group","simple-linnean-subgroup","linnean-family","type","BOOLEAN-TYPE"];for(a in d)r=d[a],a=a.replace(/_/g,"-"),n=".cndb-filter[data-column='"+a+"']",indexOf.call(p,a)<0?(console.debug("Col '"+a+"' is not a simple filter"),$(n).attr("value",r),k=!0):$(".cndb-filter[data-column='"+a+"']").polymerSelected(r);k&&$("#collapse-advanced").collapse("show")}catch(a){e=a,c=!1}}catch(a){e=a,console.error("Bad argument "+uri.query+" => "+i+", looseState, fuzzyState",j,g,searchParams.apiPath+"?q="+i),console.warn(e.message),i=""}return isNull(i)||"#"===i?(stopLoad(),$("#search").attr("disabled",!1),(f=function(){var a;if(null!=("undefined"!=typeof Polymer&&null!==Polymer&&null!=(a=Polymer.Base)?a.$$:void 0)&&!isNull(Polymer.Base.$$("#loose")))return _asm.polymerReady=!0,delay(250,function(){return d$("#loose").attr("checked","checked"),eutheriaFilterHelper()}),!1;if(null==_asm.stateIter&&(_asm.stateIter=0),++_asm.stateIter>30)return console.warn("Couldn't attach Polymer.Base.ready"),!1;try{return Polymer.Base.ready(function(){return _asm.polymerReady=!0,delay(250,function(){return d$("#loose").attr("checked","checked"),eutheriaFilterHelper()})})}catch(a){return delay(250,function(){return f()})}})()):$.get(searchParams.targetApi,"q="+i,"json").done(function(a){return _asm.polymerReady=!0,console.debug("Server query got",a),!0===a.status&&a.count>0?(console.log("Got a valid result, formatting "+a.count+" results."),formatSearchResults(a,void 0,function(){return console.log("Format results finished, checking lagged update"),checkLaggedUpdate(a)}),!1):(console.warn("Bad initial search"),showBadSearchErrorMessage.debounce(null,null,null,a),console.error(a.error),console.warn(a))}).fail(function(a,b){return console.error("There was an error loading the generic table"),console.warn(a,b,a.statusText),b=a.status+" - "+a.statusText,$("#search-status").attr("text","Couldn't load table - "+b),$("#search-status")[0].show(),stopLoadError()}).always(function(){return $("#search").attr("disabled",!1),!1})});
//# sourceMappingURL=c.min.js.map