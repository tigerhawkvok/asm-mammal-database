function shuffle(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var activityIndicatorOff,activityIndicatorOn,animateLoad,bindClickTargets,bindClicks,browserBeware,byteCount,checkFileVersion,checkTaxonNear,clearSearch,d$,deepJQuery,delay,doCORSget,doFontExceptions,downloadCSVList,downloadHTMLList,foo,formatAlien,formatScientificNames,formatSearchResults,getFilters,getLocation,getMaxZ,goTo,insertCORSWorkaround,insertModalImage,isBlank,isBool,isEmpty,isJson,isNull,isNumber,isNumeric,lightboxImages,loadJS,mapNewWindows,modalTaxon,openLink,openTab,overlayOff,overlayOn,parseTaxonYear,performSearch,prepURI,randomInt,root,roundNumber,searchParams,setHistory,showBadSearchErrorMessage,showDownloadChooser,sortResults,ssar,stopLoad,stopLoadError,testCalPhotos,toFloat,toInt,toObject,toastStatusMessage,uri,slice=[].slice,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};root="undefined"!=typeof exports&&null!==exports?exports:this,uri=new Object,uri.o=$.url(),uri.urlString=uri.o.attr("protocol")+"://"+uri.o.attr("host")+uri.o.attr("directory"),uri.query=uri.o.attr("fragment"),window.locationData=new Object,locationData.params={enableHighAccuracy:!0},locationData.last=void 0,isBool=function(a){return a===!0||a===!1},isEmpty=function(a){return!a||0===a.length},isBlank=function(a){return!a||/^\s*$/.test(a)},isNull=function(a){try{if((isEmpty(a)||isBlank(a)||null==a)&&a!==!1&&0!==a)return!0}catch(b){}return!1},isJson=function(a){if("object"==typeof a)return!0;try{return JSON.parse(a),!0}catch(b){}return!1},isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isNumeric=function(a){return isNumber(a)},toFloat=function(a,b){return null==b&&(b=!1),!isNumber(a)||isNull(a)?b?NaN:0:parseFloat(a)},toInt=function(a,b){return null==b&&(b=!1),!isNumber(a)||isNull(a)?b?NaN:0:parseInt(a)},toObject=function(a){var b,c,d;d=new Object;for(c in a)b=a[c],void 0!==b&&(d[c]=b);return d},String.prototype.toBool=function(){return"true"===this.toString()},Boolean.prototype.toBool=function(){return"true"===this.toString()},Number.prototype.toBool=function(){return"1"===this.toString()},Object.size=function(a){var b,c;c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},delay=function(a,b){return setTimeout(b,a)},roundNumber=function(a,b){var c;return null==b&&(b=0),c=Math.pow(10,b),Math.round(a*c)/c},jQuery.fn.exists=function(){return jQuery(this).length>0},jQuery.fn.polymerSelected=function(a){var b,c,d,e,f,g;if(null==a&&(a=void 0),null==a){g=void 0;try{b=$(this).find("[valueattr]"),isNull(b)&&(b=$(this)),f=b.attr("valueattr"),g=$(this).find(".core-selected").attr(f)}catch(h){return c=h,!1}return("null"===g||null==g)&&(g=void 0),g}if(isBool(a)){if(console.log("setSelected "+a+" is boolean"),$(this).parent().children().removeAttribute("selected"),$(this).parent().children().removeAttribute("active"),$(this).parent().children().removeClass("core-selected"),$(this).prop("selected",a),$(this).prop("active",a),a===!0)return $(this).addClass("core-selected")}else try{return b=$(this).find("[valueattr]"),isNull(b)&&(b=$(this)),f=b.attr("valueattr"),e=$(this).find("["+f+"="+a+"]"),d=e.index(),e.parent().prop("selected",d)}catch(h){return c=h,!1}},jQuery.fn.polymerChecked=function(a){var b;return null==a&&(a=void 0),null!=a?jQuery(this).prop("checked",a):(b=jQuery(this)[0].checked,("null"===b||null==b)&&(b=void 0),b)},jQuery.fn.isVisible=function(){return"none"!==jQuery(this).css("display")},jQuery.fn.hasChildren=function(){return Object.size(jQuery(this).children())>3},byteCount=function(a){return function(a){return encodeURI(a).split(/%..|./).length-1}}(this),randomInt=function(a,b){var c,d,e;return null==a&&(a=0),null==b&&(b=1),e=Math.random(),null==a&&(c=[0,a],a=c[0],b=c[1]),a>b&&(d=[b,a],a=d[0],b=d[1]),Math.floor(e*(b-a+1)+a)},window.debounce_timer=null,Function.prototype.debounce=function(){var a,b,c,d,e,f,g;if(f=arguments[0],d=arguments[1],g=arguments[2],a=4<=arguments.length?slice.call(arguments,3):[],null==f&&(f=300),null==d&&(d=!1),null==g&&(g=window.debounce_timer),e=this,b=function(){return d||e.apply(e,a),console.log("Debounce applied")},null!=g)try{clearTimeout(g)}catch(h){c=h}else d&&(e.apply(obj,a),console.log("Executed immediately"));return window.debounce_timer=setTimeout(b,f)},loadJS=function(a,b,c){var d,e,f,g;if(null==b&&(b=new Object),null==c&&(c=!0),$("script[src='"+a+"']").exists()){if("function"==typeof b)try{b()}catch(h){d=h,console.error("Script is already loaded, but there was an error executing the callback function - "+d.message)}return!0}return g=document.createElement("script"),g.setAttribute("src",a),g.setAttribute("async","async"),g.setAttribute("type","text/javascript"),g.src=a,g.async=!0,f=function(){var a;a=g.readyState;try{if(!b.done&&(!a||/loaded|complete/.test(a))&&(b.done=!0,"function"==typeof b))try{return b()}catch(c){return d=c,console.error("Postload callback error - "+d.message)}}catch(c){return d=c,console.error("Onload error - "+d.message)}},e=function(){console.warn("There may have been a problem loading "+a);try{if(!b.done&&(b.done=!0,"function"==typeof b&&c))try{return b()}catch(e){return d=e,console.error("Post error callback error - "+d.message)}}catch(e){return d=e,console.error("There was an error in the error handler! "+d.message)}},g.setAttribute("onload",f),g.setAttribute("onreadystate",f),g.setAttribute("onerror",e),g.onload=g.onreadystate=f,g.onerror=e,document.getElementsByTagName("head")[0].appendChild(g),!0},String.prototype.toTitleCase=function(){var a,b,c,d,e,f,g,h,i,j,k;for(h=this.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}),e=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"],f=0,a=e.length;a>f;f++)c=e[f],d=new RegExp("\\s"+c+"\\s","g"),h=h.replace(d,function(a){return a.toLowerCase()});for(k=["Id","Tv"],g=0,b=k.length;b>g;g++)i=k[g],j=new RegExp("\\b"+i+"\\b","g"),h=h.replace(j,i.toUpperCase());return h},mapNewWindows=function(a){return null==a&&(a=!0),$(".newwindow").each(function(){var b,c;return b=$(this).attr("href"),null==b&&(b=$(this).attr("data-href")),c=function(a){return null==a?!1:(window.open(a),!1)},$(this).click(function(d){return a&&(d.preventDefault(),d.stopPropagation()),c(b)}),$(this).keypress(function(){return c(b)})})},toastStatusMessage=function(a,b,c,d){var e;return null==b&&(b=""),null==c&&(c=3e3),null==d&&(d="#search-status"),isNumber(c)||(c=3e3),d.slice(0,1)===!1&&(d="#"+d),$(d).exists()||(e='<paper-toast id="'+d.slice(1)+'" duration="'+c+'"></paper-toast>',$(e).appendTo("body")),$(d).attr("text",a),$(d).addClass(b),$(d)[0].show(),delay(c+500,function(){return $(d).empty(),$(d).removeClass(b),$(d).attr("text","")})},openLink=function(a){return null==a?!1:(window.open(a),!1)},openTab=function(a){return openLink(a)},goTo=function(a){return null==a?!1:(window.location.href=a,!1)},animateLoad=function(a){var b,c;null==a&&(a="loader"),isNumber(a)&&(a="loader"),"#"===a.slice(0,1)?(c=a,a=a.slice(1)):c="#"+a;try{return $(c).exists()?$(c).attr("active",!0):$("body").append('<paper-spinner id="'+a+'" active></paper-spinner'),!1}catch(d){return b=d,console.warn("Could not animate loader",b.message)}},stopLoad=function(a,b){var c,d;null==a&&(a="loader"),null==b&&(b=1e3),"#"===a.slice(0,1)?(d=a,a=a.slice(1)):d="#"+a;try{if($(d).exists())return $(d).addClass("good"),delay(b,function(){return $(d).removeClass("good"),$(d).attr("active",!1),$(d).removeAttr("active")})}catch(e){return c=e,console.warn("Could not stop load animation",c.message)}},stopLoadError=function(a,b,c){var d,e;null==b&&(b="loader"),null==c&&(c=7500),"#"===b.slice(0,1)?(e=b,b=b.slice(1)):e="#"+b;try{if($(e).exists())return $(e).addClass("bad"),null!=a&&toastStatusMessage(a,"",c),delay(c,function(){return $(e).removeClass("bad"),$(e).attr("active",!1)})}catch(f){return d=f,console.warn("Could not stop load error animation",d.message)}},doCORSget=function(a,b,c,d){var e,f,g,h,i;null==c&&(c=void 0),null==d&&(d=void 0),e=function(){if("function"==typeof d)return d();throw new Error("There was an error performing the CORS request")},h={url:a,data:b,type:"get",crossDomain:!0};try{$.ajax(h).done(function(a){return"function"==typeof c?(c(),!1):void 0}).fail(function(a,b){return console.warn("Couldn't perform jQuery AJAX CORS. Attempting manually.")})}catch(j){g=j,console.warn("There was an error using jQuery to perform the CORS request. Attemping manually.")}if(a=a+"?"+b,f=function(a,b){var c;return null==a&&(a="get"),c=new XMLHttpRequest,"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(a,b)):c=null,c},i=f("get",a),!i)throw new Error("CORS not supported");return i.onload=function(){var a;return a=i.responseText,"function"==typeof c&&c(a),!1},i.onerror=function(){return console.warn("Couldn't do manual XMLHttp CORS request"),e()},i.send(),!1},deepJQuery=function(a){var b;try{if(!$("html /deep/ "+a).exists())throw"Bad /deep/ selector";return $("html /deep/ "+a)}catch(c){b=c;try{if(!$("html >>> "+a).exists())throw"Bad >>> selector";return $("html >>> "+a)}catch(c){return b=c,$(a)}}},d$=function(a){return deepJQuery(a)},lightboxImages=function(a,b){var c,d;return null==a&&(a=".lightboximage"),null==b&&(b=!1),d={onStart:function(){return overlayOn()},onEnd:function(){return overlayOff(),activityIndicatorOff()},onLoadStart:function(){return activityIndicatorOn()},onLoadEnd:function(){return activityIndicatorOff()},allowedTypes:"png|jpg|jpeg|gif|bmp|webp",quitOnDocClick:!0,quitOnImgClick:!0},c=b?d$(a):$(a),c.click(function(a){try{return $(this).imageLightbox(d).startImageLightbox(),a.preventDefault(),a.stopPropagation(),console.warn("Event propagation was stopped when clicking on this.")}catch(b){return a=b,console.error("Unable to lightbox this image!")}}).each(function(){var a,b,c;try{if("img"===$(this).prop("tagName").toLowerCase()&&"a"!==$(this).parent().prop("tagName").toLowerCase())return c=$(this).removeClass("lightboximage").prop("outerHTML"),b=function(){switch(!1){case!!isNull($(this).attr("data-layzr-retina")):return $(this).attr("data-layzr-retina");case!!isNull($(this).attr("data-layzr")):return $(this).attr("data-layzr");default:return $(this).attr("src")}}.call(this),$(this).replaceWith("<a href='"+b+"' class='lightboximage'>"+c+"</a>")}catch(d){return a=d,console.warn("Couldn't parse through the elements")}})},activityIndicatorOn=function(){return $('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},activityIndicatorOff=function(){return $("#imagelightbox-loading").remove(),$("#imagelightbox-overlay").click(function(){return $("#imagelightbox").click()})},overlayOn=function(){return $('<div id="imagelightbox-overlay"></div>').appendTo("body")},overlayOff=function(){return $("#imagelightbox-overlay").remove()},formatScientificNames=function(a){return null==a&&(a=".sciname"),$(".sciname").each(function(){var a;return a="italic"===$(this).css("font-style")?"normal":"italic",$(this).css("font-style",a)})},prepURI=function(a){return a=encodeURIComponent(a),a.replace(/%20/g,"+")},getLocation=function(a){var b,c;return null==a&&(a=void 0),c=function(a,b){return window.locationData.lat=a.coords.latitude,window.locationData.lng=a.coords.longitude,window.locationData.acc=a.coords.accuracy,window.locationData.last=Date.now(),null!=b&&b(window.locationData),!1},b=function(a,b){var c;return c=function(){switch(a.code){case 0:return"There was an error while retrieving your location: "+a.message;case 1:return"The user prevented this page from retrieving a location";case 2:return"The browser was unable to determine your location: "+a.message;case 3:return"The browser timed out retrieving your location."}}(),console.error(c),null!=b&&b(!1),!1},navigator.geolocation?navigator.geolocation.getCurrentPosition(c,b,window.locationData.params):(console.warn("This browser doesn't support geolocation!"),null!=a?a(!1):void 0)},bindClickTargets=function(){return bindClicks(),!1},bindClicks=function(a){return null==a&&(a=".click"),$(a).each(function(){var a,b,c;try{if(c=$(this).attr("data-href"),isNull(c)&&(c=$(this).attr("data-url"),null!=c&&$(this).attr("data-newtab","true")),!isNull(c)){$(this).unbind();try{c===uri.o.attr("path")&&"paper-tab"===$(this).prop("tagName").toLowerCase()&&$(this).parent().prop("selected",$(this).index())}catch(d){b=d,console.warn("tagname lower case error")}return $(this).click(function(){var a,b,d;return c=$(this).attr("data-href"),isNull(c)&&(c=$(this).attr("data-url")),(null!=(a=$(this).attr("newTab"))?a.toBool():void 0)||(null!=(b=$(this).attr("newtab"))?b.toBool():void 0)||(null!=(d=$(this).attr("data-newtab"))?d.toBool():void 0)?openTab(c):goTo(c)}),c}if(a=$(this).attr("data-function"),null!=a)return $(this).unbind(),$(this).click(function(){try{return window[a]()}catch(c){return b=c,console.error("'"+a+"()' is a bad function - "+b.message)}})}catch(d){return b=d,console.error("There was a problem binding to #"+$(this).attr("id")+" - "+b.message)}}),!1},getMaxZ=function(){var a;return a=function(){return $.map($("body *"),function(a,b){return"static"!==$(a).css("position")?parseInt($(a).css("z-index")||1):void 0})},Math.max.apply(null,a())},browserBeware=function(){var a,b,c;null==window.hasCheckedBrowser&&(window.hasCheckedBrowser=0);try{if(a=new WhichBrowser,a.isBrowser("Firefox")&&(c='<div id="firefox-warning" class="alert alert-warning alert-dismissible fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>Warning!</strong> Firefox has buggy support for <a href="http://webcomponents.org/" class="alert-link">webcomponents</a> and the <a href="https://www.polymer-project.org" class="alert-link">Polymer project</a>. If you encounter bugs, try using Chrome (recommended), Opera, Safari, Internet Explorer, or your phone instead &#8212; they\'ll all be faster, too.\n</div>',$("#title").after(c),$(".alert").alert(),console.warn("We've noticed you're using Firefox. Firefox has problems with this site, we recommend trying Google Chrome instead:","https://www.google.com/chrome/"),console.warn("Firefox took "+250*window.hasCheckedBrowser+"ms after page load to render this error message.")),a.isBrowser("Internet Explorer")||a.isBrowser("Safari"))return $("#collapse-button").click(function(){return $(".collapse").collapse("toggle")})}catch(d){return b=d,100===window.hasCheckedBrowser?(console.warn("We can't check your browser!"),console.warn("Known issues:"),console.warn("Firefox: Some VERY buggy behaviour"),console.warn("IE & Safari: The advanced options may not open"),!1):delay(250,function(){return window.hasCheckedBrowser++,browserBeware()})}},checkFileVersion=function(a){var b;return null==a&&(a=!1),b=function(){return $.get(uri.urlString+"meta.php","do=get_last_mod","json").done(function(b){var c;return a&&console.log("Forced version check:",b),isNumber(b.last_mod)?(null==ssar.lastMod&&(ssar.lastMod=b.last_mod),b.last_mod>ssar.lastMod?(c='<div id="outdated-warning" class="alert alert-info alert-dismissible fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>We have page updates!</strong> This page has been updated since you last refreshed. <a class="alert-link" id="refresh-page" style="cursor:pointer">Click here to refresh now</a> and get bugfixes and updates.\n</div>',$("#outdated-warning").exists()||($("body").append(c),$("#refresh-page").click(function(){return document.location.reload(!0)})),console.warn("Your current version is out of date! Please refresh the page.")):a?console.log("Your version is up to date: have "+ssar.lastMod+", got "+b.last_mod):void 0):!1}).fail(function(){return console.warn("Couldn't check file version!!")}).always(function(){return delay(3e5,function(){return b()})})},a||null==ssar.lastMod?(b(),!0):!1},foo=function(){return toastStatusMessage("Sorry, this feature is not yet finished"),stopLoad(),!1},$(function(){var a;formatScientificNames(),bindClicks(),mapNewWindows();try{$('[data-toggle="tooltip"]').tooltip()}catch(b){a=b,console.warn("Tooltips were attempted to be set up, but do not exist")}try{checkAdmin(),("undefined"!=typeof adminParams&&null!==adminParams?adminParams.loadAdminUi:void 0)===!0&&loadJS("js/admin.min.js",function(){return loadAdminUi()})}catch(b){a=b,getLocation(),loadJS("js/jquery.cookie.min.js",function(){var a;return null!=$.cookie("ssarherps_user")&&(a='<paper-icon-button icon="create" class="click" data-href="'+uri.urlString+'admin/" data-toggle="tooltip" title="Go to administration" id="goto-admin"></paper-icon-button>',$("#bug-footer").append(a),bindClicks("#goto-admin"),$("#goto-admin").tooltip()),!1})}return browserBeware(),checkFileVersion()}),searchParams=new Object,searchParams.targetApi="commonnames_api.php",searchParams.targetContainer="#result_container",searchParams.apiPath=uri.urlString+searchParams.targetApi,ssar=new Object,ssar.affiliateQueryUrl={amphibiaWeb:"http://amphibiaweb.org/cgi/amphib_query",reptileDatabase:"http://reptile-database.reptarium.cz/species",calPhotos:"http://calphotos.berkeley.edu/cgi/img_query",iNaturalist:"https://www.inaturalist.org/taxa/search"},performSearch=function(a){var b,c,d,e;if(null==a&&(a=void 0),null==a){if(d=$("#search").val(),e=d,d=d.toLowerCase(),c=getFilters(),(isNull(d)||null==d)&&isNull(c))return $("#search-status").attr("text","Please enter a search term."),$("#search-status")[0].show(),!1;$("#search").blur(),d=d.replace(/\./g,""),d=prepURI(d),$("#loose").polymerChecked()&&(d+="&loose=true"),$("#fuzzy").polymerChecked()&&(d+="&fuzzy=true"),isNull(c)||(d=d+"&filter="+c),b="q="+d}else a===!0?(b="q=",e="(all items)"):(b="q="+a,e=a.split("&")[0]),console.log("Searching on "+a);return"#"===d||isNull(d)&&isNull(b)||"q="===b&&a!==!0?!1:(animateLoad(),isNull(c)||console.log("Got search value "+d+", hitting",searchParams.apiPath+"?"+b),$.get(searchParams.targetApi,b,"json").done(function(a){return 0===toInt(a.count)?(showBadSearchErrorMessage(a),clearSearch(!0),!1):a.status===!0?(formatSearchResults(a),!1):(clearSearch(!0),$("#search-status").attr("text",a.human_error),$("#search-status")[0].show(),console.error(a.error),console.warn(a),stopLoadError())}).fail(function(a,b){return console.error("There was an error performing the search"),console.warn(a,b,a.statusText),b=a.status+" - "+a.statusText,$("#search-status").attr("text","Couldn't execute the search - "+b),$("#search-status")[0].show(),stopLoadError()}).always(function(){var a;return a=Base64.encodeURI(d),null!=d&&setHistory(uri.urlString+"#"+a),!1}))},getFilters=function(a,b){var c,d,e,f,g;if(null==a&&(a=".cndb-filter"),null==b&&(b="AND"),f=new Object,$(a).each(function(){var a,b;return a=$(this).attr("data-column"),null==a?!0:(b=$(this).polymerSelected(),"any"===b||"all"===b||"*"===b?!0:(isNull(b)||b===!1)&&(b=$(this).val(),isNull(b))?!0:f[a]=b.toLowerCase())}),c=$("#alien-filter").get(0).selected,"both"!==c&&(f.is_alien="alien-only"===c?1:0),0===Object.size(f))return"";try{return f.BOOLEAN_TYPE=b,g=JSON.stringify(f),e=Base64.encodeURI(g)}catch(h){return d=h,!1}},formatSearchResults=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;null==b&&(b=searchParams.targetContainer),i=a.result,searchParams.result=i,n=new Array,o="",q="<table id='cndb-result-list' class='table table-striped table-hover col-md-12'>\n	<tr class='cndb-row-headers'>",p="</table>",D=toInt(a.count)-1,g=null,d=0,j=["id","minor_type","notes","major_type","taxon_author","taxon_credit","image_license","image_credit","taxon_credit_date","parens_auth_genus","parens_auth_species","is_alien"],l=0,y=delay(5e3,function(){return stopLoadError("There was a problem parsing the search results."),console.error("Couldn't finish parsing the results! Expecting "+D+" elements, timed out on "+l+"."),console.warn(i),!1}),z=[];for(s in i){if(A=i[s],l=s,0===toInt(s)){t=0,q+="\n<!-- Table Headers - "+Object.size(A)+" entries -->";for(u in A)F=A[u],x=u.replace(/_/g," "),indexOf.call(j,u)<0&&(c=$("#show-deprecated").polymerSelected()!==!0?"deprecated_scientific":"",u!==c&&(x=function(){switch(x){case"common name":return"english name";case"major subtype":return"english subtype";default:return x}}(),q+="\n		<th class='text-center'>"+x+"</th>",d++)),t++,t===Object.size(A)&&(q+="\n	</tr>",q+="\n<!-- End Table Headers -->",e=roundNumber(12/d,0),g="col-md-"+e)}E=A.genus+"+"+A.species,isNull(A.subspecies)||(E=E+"+"+A.subspecies),r="\n	<tr id='cndb-row"+s+"' class='cndb-result-entry' data-taxon=\""+E+'">',w=0;for(u in A){if(f=A[u],indexOf.call(j,u)<0){if("authority_year"===u)try{try{h=JSON.parse(f)}catch(H){k=H,console.warn("There was an error parsing '"+f+"', attempting to fix - ",k.message),C=f.split(":"),G=C[1].slice(C[1].search('"')+1,-2),console.log("Examining "+G),G=G.replace(/"/g,"'"),C[1]='"'+G+'"}',f=C.join(":"),console.log("Reconstructed "+f),h=JSON.parse(f)}m=Object.keys(h)[0],B=h[m],f="G: "+m+"<br/>S: "+B}catch(H){k=H,console.error("There was an error parsing '"+f+"'",k.message),h=f}c=$("#show-deprecated").polymerSelected()!==!0?"deprecated_scientific":"",u!==c&&("image"===u&&(f=isNull(f)?"<paper-icon-button icon='launch' data-href='"+ssar.affiliateQueryUrl.calPhotos+"?rel-taxon=contains&where-taxon="+E+"' class='newwindow calphoto click' data-taxon=\""+E+'"></paper-icon-button>':"<paper-icon-button icon='image:image' data-lightbox='"+uri.urlString+f+"' class='lightboximage'></paper-icon-button>"),v="genus"!==u&&"species"!==u&&"subspecies"!==u?u+" text-center":u,("genus_authority"===u||"species_authority"===u)&&(v+=" authority"),r+="\n		<td id='"+u+"-"+s+"' class='"+v+" "+g+"'>"+f+"</td>")}w++,w===Object.size(A)&&(r+="\n	</tr>",o+=r)}toInt(s)===D?(o=q+o+p,$(b).html(o),clearTimeout(y),mapNewWindows(),lightboxImages(),modalTaxon(),doFontExceptions(),$("#result-count").text(" - "+a.count+" entries"),testCalPhotos(),z.push(stopLoad())):z.push(void 0)}return z},parseTaxonYear=function(a,b){var c,d,e,f,g,h;null==b&&(b=!0);try{c=JSON.parse(a)}catch(i){d=i,console.warn("There was an error parsing '"+a+"', attempting to fix - ",d.message),g=a.split(":"),h=g[1].slice(g[1].search('"')+1,-2),console.log("Examining "+h),h=h.replace(/"/g,"'"),g[1]='"'+h+'"}',a=g.join(":"),console.log("Reconstructed "+a);try{c=JSON.parse(a)}catch(i){return d=i,b?!1:a}}return e=Object.keys(c)[0],f=c[e],h=new Object,h.genus=e,h.species=f,h},formatAlien=function(a,b){var c,d,e,f;if(null==b&&(b="#is-alien-container"),"boolean"==typeof a)d=a;else{if("object"!=typeof a)throw Error("Invalid data given to formatAlien()");d=toInt(a.is_alien).toBool()}return d?(c='<core-icon icon="maps:flight" class="small-icon alien-speices" id="modal-alien-species" data-toggle="tooltip"></core-icon>',d$(b).html(c),e="This species is not native",f='<div class="tooltip fade top in right manual-placement-tooltip" role="tooltip" style="top: 6.5em; left: 4em; right:initial; display:none" id="manual-alien-tooltip">\n  <div class="tooltip-arrow" style="top:50%;left:5px"></div>\n  <div class="tooltip-inner">'+e+"</div>\n</div>",d$(b).after(f).mouseenter(function(){return d$("#manual-alien-tooltip").css("display","block"),!1}).mouseleave(function(){return d$("#manual-alien-tooltip").css("display","none"),!1}),d$("#manual-location-tooltip").css("left","6em"),!1):(d$(b).css("display","none"),!1)},checkTaxonNear=function(a,b,c){var d,e,f,g,h,i;return null==a&&(a=void 0),null==b&&(b=void 0),null==c&&(c="#near-me-container"),null==a?(console.warn("Please specify a taxon."),!1):(null==locationData.last&&getLocation(),g=(Date.now()-locationData.last)/1e3,g>900&&getLocation(),d="http://www.inaturalist.org/places.json",e="taxon="+a+"&latitude="+locationData.lat+"&longitude="+locationData.lng+"&place_type=county",h="",f="",i="",$.get(d,e,"json").done(function(a){return Object.size(a)>0?(h="communication:location-on",f="good-location",i="This species occurs in your county"):(h="communication:location-off",f="bad-location",i="This species does not occur in your county")}).fail(function(a,b){return f="bad-location",h="warning",i="We couldn't determine your location"}).always(function(){var a;return a='<div class="tooltip fade top in right manual-placement-tooltip" role="tooltip" style="top: 6.5em; left: 4em; right:initial; display:none" id="manual-location-tooltip">\n  <div class="tooltip-arrow" style="top:50%;left:5px"></div>\n  <div class="tooltip-inner">'+i+"</div>\n</div>",d$(c).html("<core-icon icon='"+h+"' class='small-icon "+f+" near-me' data-toggle='tooltip' id='near-me-icon'></core-icon>"),$(c).after(a).mouseenter(function(){return d$("#manual-location-tooltip").css("display","block"),!1}).mouseleave(function(){return d$("#manual-location-tooltip").css("display","none"),!1}),null!=b?b():void 0}),!1)},insertModalImage=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;if(null==a&&(a=ssar.taxonImage),null==b&&(b=ssar.activeTaxon),null==c&&(c=void 0),null==b)return console.error("Tried to insert a modal image, but no taxon was provided!"),!1;if("object"!=typeof b)return console.error("Invalid taxon data type (expecting object), got "+typeof b),o={taxon:b,imageUrl:i,defaultTaxon:ssar.activeTaxon,defaultImage:ssar.taxonImage},console.warn(o),!1;if(l=function(a,b,d){var e,f,g,h,i,j,k;null==d&&(d="calphoto"),k=a.thumbUri,i=a.imageUri,j="function"==typeof a.imageLinkUri?a.imageLinkUri(a.imageUri):void 0,h=a.imageLicense,g=a.imageCredit,f='<div class="modal-img-container">\n  <a href="'+i+'" class="'+d+'-img-anchor center-block text-center">\n    <img src="'+k+'"\n      data-href="'+j+'"\n      class="'+d+'-img-thumb"\n      data-taxon="'+b+'" />\n  </a>\n  <p class="small text-muted text-center">\n    Image by '+g+" under "+h+"\n  </p>\n</div>",d$("#meta-taxon-info").before(f);try{lightboxImages("."+d+"-img-anchor",!0)}catch(l){e=l,console.error("Error lightboxing images")}return"function"==typeof c&&c(),!1},m=[b.genus,b.species],null!=b.subspecies&&m.push(b.subspecies),n=m.join("+"),null!=a.imageUri)return"string"==typeof a&&(i=a,a=new Object,a.imageUri=i),j=a.imageUri.split("."),g=j.pop(),k=j.join("."),a.thumbUri=""+uri.urlString+k+"-thumb."+g,a.imageUri=""+uri.urlString+k+"."+g,l(a,n,"ssarimg"),!1;d="getthumbinfo=1&num=all&cconly=1&taxon="+n+"&format=xml",e=function(b){var c,e,f;if(f=xmlToJSON.parseString(b),window.testData=f,c=f.calphotos[0],null==c)return console.warn("CalPhotos didn't return any valid images for this search!"),!1;a=new Object;try{if(a.thumbUri=c.thumb_url[0]._text,null==a.thumbUri)return console.warn("CalPhotos didn't return any valid images for this search!"),!1;a.imageUri=c.enlarge_jpeg_url[0]._text,a.imageLinkUri=c.enlarge_url[0]._text,a.imageLicense=c.license[0]._text,a.imageCredit=c.copyright[0]._text+" (via CalPhotos)"}catch(g){return e=g,console.warn("CalPhotos didn't return any valid images for this search!",ssar.affiliateQueryUrl.calPhotos+"?"+d),!1}return l(a,n),!1},h=function(a,b){return insertCORSWorkaround(),console.error("Couldn't load a CalPhotos image to insert!"),!1};try{doCORSget(ssar.affiliateQueryUrl.calPhotos,d,e,h)}catch(p){f=p,console.error(f.message)}return!1},testCalPhotos=function(){var a,b;a="getthumbinfo=1&num=all&cconly=1&taxon=batrachoseps&format=xml";try{$.get(ssar.affiliateQueryUrl.calPhotos,a).done(function(){return!1}).fail(function(){return insertCORSWorkaround()})}catch(c){b=c}return!1},modalTaxon=function(a){var b;return null==a&&(a=void 0),null==a?($(".cndb-result-entry").click(function(){return modalTaxon($(this).attr("data-taxon"))}),!1):(animateLoad(),$("#modal-taxon").exists()||(b="<paper-action-dialog backdrop layered closeSelector=\"[affirmative]\" id='modal-taxon'>\n  <div id='modal-taxon-content'></div>\n  <paper-button dismissive id='modal-inat-linkout'>iNaturalist</paper-button>\n  <paper-button dismissive id='modal-calphotos-linkout' class=\"hidden-xs\">CalPhotos</paper-button>\n  <paper-button dismissive id='modal-alt-linkout' class=\"hidden-xs\"></paper-button>\n  <paper-button affirmative autofocus>Close</paper-button>\n</paper-action-dialog>",$("#result_container").after(b)),$.get(searchParams.targetApi,"q="+a,"json").done(function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(f=c.result[0],null==f)return toastStatusMessage("There was an error fetching the entry details. Please try again later."),stopLoadError(),!1;if(t=parseTaxonYear(f.authority_year),u="",t!==!1&&(i="<span class='genus_authority authority'>"+f.genus_authority+"</span> "+t.genus,q="<span class='species_authority authority'>"+f.species_authority+"</span> "+t.species,toInt(f.parens_auth_genus).toBool()&&(i="("+i+")"),toInt(f.parens_auth_species).toBool()&&(q="("+q+")"),u="<div id=\"is-alien-container\" class=\"tooltip-container\"></div>\n<div id='near-me-container' data-toggle='tooltip' data-placement='top' title='' class='near-me tooltip-container'></div>\n<p>\n  <span class='genus'>"+f.genus+"</span>,\n  "+i+";\n  <span class='species'>"+f.species+"</span>,\n  "+q+"\n</p>"),g="",!isNull(f.deprecated_scientific)){g="<p>Deprecated names: ";try{p=JSON.parse(f.deprecated_scientific),k=0,$.each(p,function(a,b){return k++,1!==k&&(g+="; "),g+="<span class='sciname'>"+a+"</span>, "+b,k===Object.size(p)?g+="</p>":void 0})}catch(v){h=v,g="",console.error("There were deprecated scientific names, but the JSON was malformed.")}}l="",isNull(f.minor_type)||(l=" <core-icon icon='arrow-forward'></core-icon> <span id='taxon-minor-type'>"+f.minor_type+"</span>"),isNull(f.notes)?(f.notes="Sorry, we have no notes on this taxon yet.",f.taxon_credit=""):isNull(f.taxon_credit)||"null"===f.taxon_credit?f.taxon_credit="This taxon information is uncredited.":(s=isNull(f.taxon_credit_date)||"null"===f.taxon_credit_date?"":" ("+f.taxon_credit_date+")",f.taxon_credit="Taxon information by "+f.taxon_credit+"."+s);try{m=markdown.toHTML(f.notes)}catch(v){h=v,m=f.notes,console.warn("Couldn't parse markdown!! "+h.message)}return e=isNull(f.major_common_type)?"":" (<span id='taxon-common-type'>"+f.major_common_type+"</span>) ",b="<div id='meta-taxon-info'>\n  "+u+"\n  <p>\n    English name: <span id='taxon-common-name' class='common_name'>"+f.common_name+"</span>\n  </p>\n  <p>\n    Type: <span id='taxon-type' class=\"major_type\">"+f.major_type+"</span>\n    "+e+"\n    <core-icon icon='arrow-forward'></core-icon>\n    <span id='taxon-subtype' class=\"major_subtype\">"+f.major_subtype+"</span>"+l+"\n  </p>\n  "+g+"\n</div>\n<h3>Taxon Notes</h3>\n<p id='taxon-notes'>"+m+'</p>\n<p class="text-right small text-muted">'+f.taxon_credit+"</p>",$("#modal-taxon-content").html(b),$("#modal-inat-linkout").unbind().click(function(){return openTab(ssar.affiliateQueryUrl.iNaturalist+"?q="+a)}),$("#modal-calphotos-linkout").unbind().click(function(){return openTab(ssar.affiliateQueryUrl.calPhotos+"?rel-taxon=contains&where-taxon="+a)}),n=null,d=null,"caudata"===(o=f.linnean_order.toLowerCase())||"anura"===o||"gymnophiona"===o?(d="AmphibiaWeb",n=ssar.affiliateQueryUrl.amphibiaWeb+"?where-genus="+f.genus+"&where-species="+f.species):isNull(f.linnean_order)||(d="Reptile Database",n=ssar.affiliateQueryUrl.reptileDatabase+"?genus="+f.genus+"&species="+f.species),null!=n?$("#modal-alt-linkout").removeClass("hidden").text(d).unbind().click(function(){return openTab(n)}):$("#modal-alt-linkout").addClass("hidden").unbind(),formatScientificNames(),doFontExceptions(),j=a.charAt(0).toUpperCase()+a.slice(1),j=j.replace(/\+/g," "),$("#modal-taxon").attr("heading",j),r=a.split("+"),ssar.activeTaxon={genus:r[0],species:r[1],subspecies:r[2]},isNull(f.image)&&(f.image=void 0),ssar.taxonImage={imageUri:f.image,imageCredit:f.image_credit,imageLicense:f.image_license},insertModalImage(),checkTaxonNear(a,function(){return formatAlien(f),stopLoad(),$("#modal-taxon")[0].open()})}).fail(function(a,b){return stopLoadError()}),!1)},doFontExceptions=function(){
var a,b;return a=["de","and"],b=function(b){return $.each(a,function(a,c){var d;return d=" "+c+" ",null!=b?b=b.replace(d," <span class='force-lower'>"+c+"</span> "):void 0}),b},d$(".authority").each(function(){var a;return a=$(this).text(),isNull(a)?void 0:$(this).html(b(a))}),!1},sortResults=function(a){var b;return b=searchParams.result},setHistory=function(a,b,c){return null==a&&(a="#"),null==b&&(b=null),null==c&&(c=null),history.pushState(b,c,a),uri.query=$.url(a).attr("fragment"),!1},clearSearch=function(a){var b;return null==a&&(a=!1),$("#result-count").text(""),b='<div class="bs-callout bs-callout-info center-block col-xs-12 col-sm-8 col-md-5">\n  Search for a common or scientific name above to begin, eg, "California slender salamander" or "<span class="sciname">Batrachoseps attenuatus</span>"\n</div>',$("#result_container").html(b),a===!0?!1:(setHistory(),$(".cndb-filter").attr("value",""),$("#collapse-advanced").collapse("hide"),$("#search").attr("value",""),$("#linnean-order").polymerSelected("any"),formatScientificNames(),!1)},downloadCSVList=function(){var a,b,c,d,e;return animateLoad(),a="q=*",b=new Date,e=1===b.getMonth().toString().length?"0"+(b.getMonth()+1):b.getMonth()+1,d=1===b.getDate().toString().length?"0"+b.getDate().toString():b.getDate(),c=b.getUTCFullYear()+"-"+e+"-"+d,$.get(""+searchParams.apiPath,a,"json").done(function(b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;try{if(b.status!==!0)throw Error("Invalid Result");h="      ",i=new Array,w=["genus","species","subspecies","common_name","image","image_credit","image_license","major_type","major_common_type","major_subtype","minor_type","linnean_order","genus_authority","species_authority","deprecated_scientific","notes","taxon_credit","taxon_credit_date"],t=["genus","common_name","taxon_author","major_subtype","linnean_order"],r=0,u=b.result;for(s in u)if(v=u[s],k=new Array,!isNull(v.genus)){for(l in v)if(m=v[l],e=l.replace(/"/g,'""'),f=m.replace(/"/g,'""').replace(/&#39;/g,"'"),0===r&&indexOf.call(w,e)>=0&&i.push(e.replace(/_/g," ").toTitleCase()),indexOf.call(w,e)>=0){if(/[a-z]+_authority/.test(e))try{d=JSON.parse(v.authority_year),p="",x="";for(s in d)z=d[s],p=s.replace(/"/g,'""').replace(/&#39;/g,"'"),x=z.replace(/"/g,'""').replace(/&#39;/g,"'");switch(e.split("_")[0]){case"genus":y=f.toTitleCase()+" "+p,toInt(v.parens_auth_genus).toBool()&&(y="("+y+")");break;case"species":y=f.toTitleCase()+" "+x,toInt(v.parens_auth_species).toBool()&&(y="("+y+")")}f=y}catch(A){o=A}indexOf.call(t,e)>=0&&(f=f.toTitleCase()),"image"!==e||isNull(f)||(f="http://ssarherps.org/cndb/"+f),k.push('"'+f+'"')}r++,j=k.join(","),h+="\n"+j}return g=i.join(",")+"\n"+h,n="data:text/csv;charset=utf-8,"+encodeURIComponent(g),q='<paper-action-dialog class="download-file" id="download-csv-file" heading="Your file is ready">\n  <div class="dialog-content">\n    <p>\n      Please note that some special characters in names may be decoded incorrectly by Microsoft Excel. If this is a problem, following the steps in <a href="https://github.com/SSARHERPS/SSAR-species-database/blob/master/meta/excel_unicode_readme.md"  onclick=\'window.open(this.href); return false;\' onkeypress=\'window.open(this.href); return false;\'>this README <core-icon icon="launch"></core-icon></a> to force Excel to format it correctly.\n    </p>\n    <p class="text-center">\n      <a href="'+n+'" download="ssar-common-names-'+c+'.csv" class="btn btn-default"><core-icon icon="file-download"></core-icon> Download Now</a>\n    </p>\n  </div>\n  <paper-button dismissive>Close</paper-button>\n</paper-action-dialog>',$("#download-csv-file").exists()?$("#download-csv-file").replaceWith(q):$("body").append(q),$("#download-csv-file").get(0).open(),stopLoad()}catch(A){return o=A,stopLoadError("There was a problem creating the CSV file. Please try again later."),console.error("Exception in downloadCSVList() - "+o.message),console.warn("Got",b,"from",searchParams.apiPath+"?"+a,b.status)}}).fail(function(){return stopLoadError("There was a problem communicating with the server. Please try again later.")}),!1},downloadHTMLList=function(){var a,b,c,d,e,f;return animateLoad(),b=new Date,f=1===b.getMonth().toString().length?"0"+(b.getMonth()+1):b.getMonth()+1,d=1===b.getDate().toString().length?"0"+b.getDate().toString():b.getDate(),c=b.getUTCFullYear()+"-"+f+"-"+d,e='     <!doctype html>\n     <html lang="en">\n       <head>\n         <title>SSAR Common Names Checklist ver. '+c+'</title>\n         <meta http-equiv="X-UA-Compatible" content="IE=edge">\n         <meta charset="UTF-8"/>\n         <meta name="theme-color" content="#445e14"/>\n         <meta name="viewport" content="width=device-width, initial-scale=1" />\n         <link href=\'http://fonts.googleapis.com/css?family=Droid+Serif:400,700,700italic,400italic|Roboto+Slab:400,700\' rel=\'stylesheet\' type=\'text/css\' />\n         <style type="text/css" id="ssar-checklist-inline-stylesheet">\n/*!\n* Bootstrap v3.3.5 (http://getbootstrap.com)\n* Copyright 2011-2015 Twitter, Inc.\n* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n*/\n\n/*!\n* Generated using the Bootstrap Customizer (http://getbootstrap.com/customize/?id=e14c62a4d4eee8f40b6b)\n* Config saved to config.json and https://gist.github.com/e14c62a4d4eee8f40b6b\n*//*!\n* Bootstrap v3.3.5 (http://getbootstrap.com)\n* Copyright 2011-2015 Twitter, Inc.\n* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n*//*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:0.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */@media print{*,*:before,*:after{background:transparent !important;color:#000 !important;-webkit-box-shadow:none !important;box-shadow:none !important;text-shadow:none !important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}.navbar{display:none}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000 !important}.label{border:1px solid #000}.table{border-collapse:collapse !important}.table td,.table th{background-color:#fff !important}.table-bordered th,.table-bordered td{border:1px solid #ddd !important}}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Roboto Slab","Droid Serif",Cambria,Georgia,"Times New Roman",Times,serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}a:hover,a:focus{color:#23527c;text-decoration:underline}a:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.img-responsive{display:block;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;display:inline-block;max-width:100%;height:auto}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}[role="button"]{cursor:pointer}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small,.h1 small,.h2 small,.h3 small,.h4 small,.h5 small,.h6 small,h1 .small,h2 .small,h3 .small,h4 .small,h5 .small,h6 .small,.h1 .small,.h2 .small,.h3 .small,.h4 .small,.h5 .small,.h6 .small{font-weight:normal;line-height:1;color:#777}h1,.h1,h2,.h2,h3,.h3{margin-top:20px;margin-bottom:10px}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h1 .small,.h1 .small,h2 .small,.h2 .small,h3 .small,.h3 .small{font-size:65%}h4,.h4,h5,.h5,h6,.h6{margin-top:10px;margin-bottom:10px}h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small,h4 .small,.h4 .small,h5 .small,.h5 .small,h6 .small,.h6 .small{font-size:75%}h1,.h1{font-size:36px}h2,.h2{font-size:30px}h3,.h3{font-size:24px}h4,.h4{font-size:18px}h5,.h5{font-size:14px}h6,.h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media (min-width:768px){.lead{font-size:21px}}small,.small{font-size:85%}mark,.mark{background-color:#fcf8e3;padding:.2em}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#337ab7}a.text-primary:hover,a.text-primary:focus{color:#286090}.text-success{color:#3c763d}a.text-success:hover,a.text-success:focus{color:#2b542c}.text-info{color:#31708f}a.text-info:hover,a.text-info:focus{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover,a.text-warning:focus{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover,a.text-danger:focus{color:#843534}.bg-primary{color:#fff;background-color:#337ab7}a.bg-primary:hover,a.bg-primary:focus{background-color:#286090}.bg-success{background-color:#dff0d8}a.bg-success:hover,a.bg-success:focus{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover,a.bg-info:focus{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover,a.bg-warning:focus{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover,a.bg-danger:focus{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ul,ol{margin-top:0;margin-bottom:10px}ul ul,ol ul,ul ol,ol ol{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none;margin-left:-5px}.list-inline>li{display:inline-block;padding-left:5px;padding-right:5px}dl{margin-top:0;margin-bottom:20px}dt,dd{line-height:1.42857143}dt{font-weight:bold}dd{margin-left:0}@media (min-width:768px){.dl-horizontal dt{float:left;width:160px;clear:left;text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[title],abbr[data-original-title]{cursor:help;border-bottom:1px dotted #777}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote p:last-child,blockquote ul:last-child,blockquote ol:last-child{margin-bottom:0}blockquote footer,blockquote small,blockquote .small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote footer:before,blockquote small:before,blockquote .small:before{content:\' 14 \x00A0\'}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;border-right:5px solid #eee;border-left:0;text-align:right}.blockquote-reverse footer:before,blockquote.pull-right footer:before,.blockquote-reverse small:before,blockquote.pull-right small:before,.blockquote-reverse .small:before,blockquote.pull-right .small:before{content:\'\'}.blockquote-reverse footer:after,blockquote.pull-right footer:after,.blockquote-reverse small:after,blockquote.pull-right small:after,.blockquote-reverse .small:after,blockquote.pull-right .small:after{content:\'\x00A0  14\'}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}.clearfix:before,.clearfix:after,.dl-horizontal dd:before,.dl-horizontal dd:after{content:" ";display:table}.clearfix:after,.dl-horizontal dd:after{clear:both}.center-block{display:block;margin-left:auto;margin-right:auto}.pull-right{float:right !important}.pull-left{float:left !important}.hide{display:none !important}.show{display:block !important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none !important}.affix{position:fixed}\n          /* Manual Overrides */\n          .sciname {\n            font-style: italic;\n            }\n          .entry-sciname {\n            font-style: italic;\n            font-weight: bold;\n            }\n           body { padding: 1rem; }\n           .species-entry aside:first-child {\n             margin-top: 5rem;\n             }\n           section .entry-header {\n             text-indent: 2em;\n             }\n           .clade-declaration {\n             font-variant: small-caps;\n             border-top: 1px solid #000;\n             border-bottom: 1px solid #000;\n             page-break-before: always;\n             break-before: always;\n             }\n           .species-entry {\n             page-break-inside: avoid;\n             break-inside: avoid;\n             }\n           @media print {\n             body {\n               font-size:12px;\n               }\n             .h4 {\n               font-size: 13px;\n               }\n             @page {\n               counter-increment: page;\n               /*counter-reset: page 1;*/\n                @bottom-right {\n                 content: counter(page);\n                }\n                /* margin: 0px auto; */\n               }\n           }\n         </style>\n       </head>\n       <body>\n         <div class="container-fluid">\n           <article>\n             <h1 class="text-center">SSAR Common Names Checklist ver. '+c+"</h1>",a="q=*&order=linnean_order,genus,species,subspecies",$.get(""+searchParams.apiPath,a,"json").done(function(b){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;try{if(b.status!==!0)throw Error("Invalid Result");n=new Array,m=new Array,s=b.result;for(q in s)if(v=s[q],!isNull(v.genus)&&!isNull(v.species)){try{d=JSON.parse(v.authority_year),l="",y="";for(f in d)A=d[f],l=f.replace(/&#39;/g,"'"),y=A.replace(/&#39;/g,"'");k=v.genus_authority.toTitleCase()+" "+l,toInt(v.parens_auth_genus).toBool()&&(k="("+k+")"),x=v.species_authority.toTitleCase()+" "+y,toInt(v.parens_auth_species).toBool()&&(x="("+x+")")}catch(B){i=B,console.warn("There was a problem parsing the authority information for _"+v.genus+" "+v.species+" "+v.subspecies+"_ - "+i.message),console.warn(i.stack),console.warn("We were working with",d,l,k,y,x)}try{p=markdown.toHTML(v.notes)}catch(B){i=B,console.warn("Unable to parse Markdown for _"+v.genus+" "+v.species+" "+v.subspecies+"_"),p=v.notes}o="",isNull(p)||isNull(v.taxon_credit)||(z="",isNull(v.taxon_credit_date)||(z=", "+v.taxon_credit_date),o='<p class="text-right small text-muted">\n  <cite>\n    '+v.taxon_credit+z+"\n  </cite>\n</p>"),r="",t=v.linnean_order.trim(),indexOf.call(m,t)<0&&(r+='<h2 class="clade-declaration text-capitalize text-center">'+v.linnean_order+" &#8212; "+v.major_common_type+"</h2>",m.push(v.linnean_order.trim())),u=v.genus,indexOf.call(n,u)<0&&(r+='<aside class="genus-declaration lead">\n  <span class="entry-sciname text-capitalize">'+v.genus+'</span>\n  <span class="entry-authority">'+k+"</span>\n</aside>",n.push(v.genus)),w=v.genus.slice(0,1)+". ",j='<section class="species-entry">\n  '+r+'\n  <p class="h4 entry-header">\n    <span class="entry-sciname">\n      <span class="text-capitalize">'+w+"</span> "+v.species+" "+v.subspecies+'\n    </span>\n    <span class="entry-authority">\n      '+x+'\n    </span>\n    &#8212;\n    <span class="common-name text-capitalize">\n      '+v.common_name+'\n    </span>\n  </p>\n  <div class="entry-content">\n    '+p+"\n    "+o+"\n  </div>\n</section>",e+=j}return e+="</article>\n</div>\n</body>\n</html>",h="data:text/html;charset=utf-8,"+encodeURIComponent(e),g='<paper-action-dialog class="download-file" id="download-html-file" heading="Your file is ready">\n  <div class="dialog-content">\n    <p class="text-center">\n      <a href="'+h+'" download="ssar-common-names-'+c+'.html" class="btn btn-default"><core-icon icon="file-download"></core-icon> Download Now</a>\n    </p>\n  </div>\n  <paper-button dismissive>Close</paper-button>\n</paper-action-dialog>',$("#download-html-file").exists()?$("#download-html-file").replaceWith(g):$("body").append(g),$("#download-html-file").get(0).open(),stopLoad(),console.log("Has read clades:",m)}catch(B){return i=B,stopLoadError("There was a problem creating your file. Please try again later."),console.error("Exception in downloadHTMLList() - "+i.message),console.warn("Got",b,"from",searchParams.apiPath+"?"+a,b.status),console.warn(i.stack)}}).fail(function(){return stopLoadError("There was a problem communicating with the server. Please try again later.")}),!1},showDownloadChooser=function(){var a;return a='<paper-action-dialog id="download-chooser" heading="Select Download Type">\n  <div class="dialog-content">\n    <p>\n      Once you select a file type, it will take a moment to prepare your download. Please be patient.\n    </p>\n  </div>\n    <paper-button dismissive>Cancel</paper-button>\n    <paper-button affirmative id="initiate-csv-download">CSV</paper-button>\n    <paper-button affirmative id="initiate-html-download">HTML</paper-button>\n</paper-action-dialog>',$("#download-chooser").exists()||$("body").append(a),d$("#initiate-csv-download").click(function(){return downloadCSVList(),!1}),d$("#initiate-html-download").click(function(){return downloadHTMLList(),!1}),$("#download-chooser").get(0).open(),!1},insertCORSWorkaround=function(){var a,b,c,d;if(null==ssar.hasShownWorkaround&&(ssar.hasShownWorkaround=!1),ssar.hasShownWorkaround)return!1;try{b=new WhichBrowser}catch(e){return c=e,!1}return b.isType("mobile")?(ssar.hasShownWorkaround=!0,!1):(a=function(){switch(b.browser.name){case"Chrome":return"Install the extension \"<a class='alert-link' href='https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi?utm_source=chrome-app-launcher-info-dialog'>Allow-Control-Allow-Origin: *</a>\", activate it on this domain, and you'll see them in your popups!";case"Firefox":return"Follow the instructions <a class='alert-link' href='http://www-jo.se/f.pfleger/forcecors-workaround'>for this ForceCORS add-on</a>, or try Chrome for a simpler extension. Once you've done so, you'll see photos in your popups!";case"Internet Explorer":return"Follow these <a class='alert-link' href='http://stackoverflow.com/a/20947828'>StackOverflow instructions</a> while on this site, and you'll see them in your popups!";default:return""}}(),d='<div class="alert alert-info alert-dismissible center-block fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>Want CalPhotos images in your species dialogs?</strong> '+a+"\n  We're working with CalPhotos to enable this natively, but it's a server change on their side.\n</div>",$("#result_container").before(d),$(".alert").alert(),ssar.hasShownWorkaround=!0,!1)},showBadSearchErrorMessage=function(a){var b,c,d,e;return d=a.query.replace(/\+/g," "),a.status===!0?a.query_params.filter.had_filter===!0?(b="",c=0,$.each(a.query_params.filter.filter_params,function(d,e){return"BOOLEAN_TYPE"!==d?(0!==c&&(b=filter_text+" "+a.filter.filter_params.BOOLEAN_TYPE),isNumber(toInt(e,!0))&&(e=1===toInt(e)?"true":"false"),b=b+" "+d.replace(/_/g," ")+" is "+e):void 0}),e='"'+d+'" where '+b+" returned no results."):e='"'+d+'" returned no results.':e=a.human_error,stopLoadError(e)},$(function(){var a,b,c,d,e,f,g,h,i,j;if(a="****************************************************************************\nHello developer!\nIf you're looking for hints on our API information, this site is open-source\nand released under the GPL. Just click on the GitHub link on the bottom of\nthe page, or check out https://github.com/SSARHERPS\n****************************************************************************",console.log(a),animateLoad(),window.addEventListener("popstate",function(a){var b,c;uri.query=$.url().attr("fragment");try{b=Base64.decode(uri.query)}catch(d){a=d,b=""}return console.log("Popping state to "+b),performSearch(b),c=b.split("&")[0],$("#search").attr("value",c)}),$("#do-reset-search").click(function(){return clearSearch()}),$("#search_form").submit(function(a){return a.preventDefault(),performSearch()}),$("#collapse-advanced").on("shown.bs.collapse",function(){return $("#collapse-icon").attr("icon","unfold-less")}),$("#collapse-advanced").on("hidden.bs.collapse",function(){return $("#collapse-icon").attr("icon","unfold-more")}),$("#search_form").keypress(function(a){return 13===a.which?performSearch():void 0}),$("#do-search").click(function(){return performSearch()}),$("#do-search-all").click(function(){return performSearch(!0)}),$("#linnean-order").on("core-select",function(){return isNull($("#search").val())?void 0:performSearch()}),isNull(uri.query))f="";else try{f=Base64.decode(uri.query),i=$.url(searchParams.apiPath+"?q="+f);try{g=i.param("loose").toBool()}catch(k){b=k,g=!1}try{e=i.param("fuzzy").toBool()}catch(k){b=k,e=!1}$("#loose").prop("checked",g),$("#fuzzy").prop("checked",e),j=f.split("&")[0],j=j.replace(/\+/g," ").trim(),$("#search").attr("value",j);try{c=i.param("filter"),d=JSON.parse(Base64.decode(c)),h=!1,$.each(d,function(a,b){var c,d;return a=a.replace(/_/g,"-"),d="#"+a+"-filter","type"!==a?("is-alien"!==a?$(d).attr("value",b):(c=1===toInt(b)?"alien-only":"native-only",console.log("Setting alien-filter to "+c),$("#alien-filter").get(0).selected=c,delay(750,function(){return $("#alien-filter").get(0).selected=c})),h=!0):$("#linnean-order").polymerSelected(b)}),h&&$("#collapse-advanced").collapse("show")}catch(k){b=k,c=!1}}catch(k){b=k,console.error("Bad argument "+uri.query+" => "+f+", looseState, fuzzyState",g,e,searchParams.apiPath+"?q="+f),console.warn(b.message),f=""}return isNull(f)||"#"===f?(stopLoad(),$("#search").attr("disabled",!1),$("#loose").prop("checked",!0)):$.get(searchParams.targetApi,"q="+f,"json").done(function(a){return a.status===!0&&a.count>0?(formatSearchResults(a),!1):(showBadSearchErrorMessage(a),console.error(a.error),console.warn(a))}).fail(function(a,b){return console.error("There was an error loading the generic table"),console.warn(a,b,a.statusText),b=a.status+" - "+a.statusText,$("#search-status").attr("text","Couldn't load table - "+b),$("#search-status")[0].show(),stopLoadError()}).always(function(){return $("#search").attr("disabled",!1),!1})});var adminParams,createDuplicateTaxon,createNewTaxon,deleteTaxon,handleDragDropImage,loadAdminUi,loadModalTaxonEditor,lookupEditorSpecies,renderAdminSearchResults,saveEditorEntry,verifyLoginCredentials,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};adminParams=new Object,adminParams.apiTarget="admin_api.php",adminParams.adminPageUrl="http://ssarherps.org/cndb/admin-page.html",adminParams.loginDir="admin/",adminParams.loginApiTarget=adminParams.loginDir+"async_login_handler.php",loadAdminUi=function(){var a;try{verifyLoginCredentials(function(a){var b,c;return b="<h3>\n  Welcome, "+$.cookie("ssarherps_name")+'\n  <span id="pib-wrapper-settings" class="pib-wrapper" data-toggle="tooltip" title="User Settings" data-placement="bottom">\n    <paper-icon-button icon=\'settings-applications\' class=\'click\' data-url=\''+a.login_url+'\'></paper-icon-button>\n  </span>\n  <span id="pib-wrapper-exit-to-app" class="pib-wrapper" data-toggle="tooltip" title="Go to CNDB app" data-placement="bottom">\n    <paper-icon-button icon=\'exit-to-app\' class=\'click\' data-url=\''+uri.urlString+"' id=\"app-linkout\"></paper-icon-button>\n  </span>\n</h3>\n<div id='admin-actions-block'>\n  <div class='bs-callout bs-callout-info'>\n    <p>Please be patient while the administrative interface loads.</p>\n  </div>\n</div>",$("article").html(b),$(".pib-wrapper").tooltip(),bindClicks(),c='<form id="admin-search-form" onsubmit="event.preventDefault()" class="row">\n  <div>\n    <paper-input label="Search for species" id="admin-search" name="admin-search" required autofocus floatingLabel class="col-xs-7 col-sm-8"></paper-input>\n    <paper-fab id="do-admin-search" icon="search" raisedButton class="materialblue"></paper-fab>\n    <paper-fab id="do-admin-add" icon="add" raisedButton class="materialblue"></paper-fab>\n  </div>\n</form>\n<div id=\'search-results\' class="row"></div>',$("#admin-actions-block").html(c),$("#admin-search-form").submit(function(a){return a.preventDefault()}),$("#admin-search").keypress(function(a){return 13===a.which?renderAdminSearchResults():void 0}),$("#do-admin-search").click(function(){return renderAdminSearchResults()}),$("#do-admin-add").click(function(){return createNewTaxon()}),bindClickTargets(),!1})}catch(b){a=b,$("article").html("<div class='bs-callout bs-callout-danger'><h4>Application Error</h4><p>There was an error in the application. Please refresh and try again. If this persists, please contact administration.</p></div>")}return!1},verifyLoginCredentials=function(a){var b,c,d,e;return c=$.cookie("ssarherps_auth"),e=$.cookie("ssarherps_secret"),d=$.cookie("ssarherps_link"),b="hash="+c+"&secret="+e+"&dblink="+d,$.post(adminParams.loginApiTarget,b,"json").done(function(b){return b.status===!0?a(b):goTo(b.login_url)}).fail(function(a,b){return $("article").html("<div class='bs-callout-danger bs-callout'><h4>Couldn't verify login</h4><p>There's currently a server problem. Try back again soon.</p>'</div>"),console.log(a,b),!1}),!1},renderAdminSearchResults=function(a){var b,c,d,e;return null==a&&(a="#search-results"),e=$("#admin-search").val(),isNull(e)?(toastStatusMessage("Please enter a search term"),!1):(animateLoad(),$("#admin-search").blur(),e=e.replace(/\./g,""),e=prepURI(e.toLowerCase()),b="q="+e+"&loose=true",c=Base64.encodeURI(e),d=uri.urlString+"#"+c,$("#app-linkout").attr("data-url",d),$.get(searchParams.targetApi,b,"json").done(function(b){var c,d,e,f,g,h,i;return b.status!==!0||0===b.count?(stopLoadError(),toastStatusMessage(isNull(b.human_error)?"Your search returned no results. Please try again.":b.human_error),!1):(e=b.result,f="",h="<table id='cndb-result-list' class='table table-striped table-hover'>\n	<tr class='cndb-row-headers'>",g="</table>",i=toInt(b.count)-1,d=null,c=0,$.each(e,function(b,e){var j,k,l,m;return 0===toInt(b)&&(k=0,h+="\n<!-- Table Headers - "+Object.size(e)+" entries -->",$.each(e,function(a,b){var f,g;return g=a.replace(/_/g," "),("genus"===a||"species"===a||"subspecies"===a)&&(h+="\n		<th class='text-center'>"+g+"</th>",c++),k++,k===Object.size(e)?(h+="\n		<th class='text-center'>Edit</th>",c++,h+="\n		<th class='text-center'>Delete</th>\n	</tr>",c++,h+="\n<!-- End Table Headers -->",console.log("Got "+c+" display columns."),f=roundNumber(12/c,0),d="col-md-"+f):void 0})),m=e.genus.trim()+"+"+e.species.trim(),isNull(e.subspecies)||(m=m+"+"+e.subspecies.trim()),j="\n	<tr id='cndb-row"+b+"' class='cndb-result-entry' data-taxon=\""+m+'">',l=0,$.each(e,function(a,c){return isNull(e.genus)?!0:(("genus"===a||"species"===a||"subspecies"===a)&&(j+="\n		<td id='"+a+"-"+b+"' class='"+a+" "+d+"'>"+c+"</td>"),l++,l===Object.size(e)?(j+="\n		<td id='edit-"+b+"' class='edit-taxon "+d+" text-center'><paper-icon-button icon='image:edit' class='edit' data-taxon='"+m+"'></paper-icon-button></td>",j+="\n		<td id='delete-"+b+"' class='delete-taxon "+d+" text-center'><paper-icon-button icon='delete' class='delete-taxon-button fadebg' data-taxon='"+m+"' data-database-id='"+e.id+"'></paper-icon-button></td>",j+="\n	</tr>",f+=j):void 0)}),toInt(b)===i?(f=h+f+g,$(a).html(f),console.log("Processed "+(toInt(b)+1)+" rows"),$(".edit").click(function(){var a;return a=$(this).attr("data-taxon"),lookupEditorSpecies(a)}),$(".delete-taxon-button").click(function(){var a,b;return b=$(this).attr("data-taxon"),a=$(this).attr("data-database-id"),deleteTaxon(a)}),stopLoad()):void 0}))}).fail(function(a,b){var c;return console.error("There was an error performing the search"),console.warn(a,c,a.statusText),c=a.status+" - "+a.statusText,$("#search-status").attr("text","Couldn't execute the search - "+c),$("#search-status")[0].show(),stopLoadError()}))},loadModalTaxonEditor=function(a,b){var c,d,e,f;null==a&&(a=""),null==b&&(b="Save"),d='<paper-input label="Genus" id="edit-genus" name="edit-genus" class="genus" floatingLabel></paper-input>\n<paper-input label="Species" id="edit-species" name="edit-species" class="species" floatingLabel></paper-input>\n<paper-input label="Subspecies" id="edit-subspecies" name="edit-subspecies" class="subspecies" floatingLabel></paper-input>\n<core-label>\n  Alien species?\n  <paper-toggle-button id="is-alien"  checked="false"></paper-toggle-button>\n</core-label>\n<paper-input label="Common Name" id="edit-common-name" name="edit-common-name"  class="common_name" floatingLabel></paper-input>\n<paper-input label="Deprecated Scientific Names" id="edit-deprecated-scientific" name="edit-depreated-scientific" floatingLabel aria-describedby="deprecatedHelp"></paper-input>\n  <span class="help-block" id="deprecatedHelp">List names here in the form <span class="code">"Genus species":"Authority: year","Genus species":"Authority: year",[...]</span>.<br/>There should be no spaces between the quotes and comma or colon. If there are, it may not save correctly.</span>\n<paper-input label="Clade" class="capitalize" id="edit-major-type" name="edit-major-type" floatingLabel></paper-input>\n<paper-input label="Subtype" class="capitalize" id="edit-major-subtype" name="edit-major-subtype" floatingLabel></paper-input>\n<paper-input label="Minor clade / \'Family\'" id="edit-minor-type" name="edit-minor-type" floatingLabel></paper-input>\n<paper-input label="Linnean Order" id="edit-linnean-order" name="edit-linnean-order" class="linnean_order" floatingLabel></paper-input>\n<paper-input label="Common Type (eg., \'lizard\')" id="edit-major-common-type" name="edit-major-common-type" class="major_common_type" floatingLabel></paper-input>\n<paper-input label="Genus authority" id="edit-genus-authority" name="edit-genus-authority" class="genus_authority" floatingLabel></paper-input>\n<paper-input label="Genus authority year" id="edit-gauthyear" name="edit-gauthyear" floatingLabel></paper-input>\n<core-label>\n  Use Parenthesis for Genus Authority\n  <paper-toggle-button id="genus-authority-parens"  checked="false"></paper-toggle-button>\n</core-label>\n<paper-input label="Species authority" id="edit-species-authority" name="edit-species-authority" class="species_authority" floatingLabel></paper-input>\n<paper-input label="Species authority year" id="edit-sauthyear" name="edit-sauthyear" floatingLabel></paper-input>\n<core-label>\n  Use Parenthesis for Species Authority\n  <paper-toggle-button id="species-authority-parens" checked="false"></paper-toggle-button>\n</core-label>\n<br/><br/>\n<paper-autogrow-textarea id="edit-notes-autogrow" rows="5">\n  <textarea placeholder="Notes" id="edit-notes" name="edit-notes" aria-describedby="notes-help" rows="5"></textarea>\n</paper-autogrow-textarea>\n<span class="help-block" id="notes-help">You can write your notes in Markdown. (<a href="https://daringfireball.net/projects/markdown/syntax" "onclick=\'window.open(this.href); return false;\' onkeypress=\'window.open(this.href); return false;\'">Official Full Syntax Guide</a>)</span>\n<div id="upload-image"></div>\n<span class="help-block" id="upload-image-help">You can drag and drop an image above, or enter its server path below.</span>\n<paper-input label="Image" id="edit-image" name="edit-image" floatingLabel aria-describedby="imagehelp"></paper-input>\n  <span class="help-block" id="imagehelp">The image path here should be relative to the <span class="code">public_html/cndb/</span> directory.</span>\n<paper-input label="Image Credit" id="edit-image-credit" name="edit-image-credit" floatingLabel></paper-input>\n<paper-input label="Image License" id="edit-image-license" name="edit-image-license" floatingLabel></paper-input>\n<paper-input label="Taxon Credit" id="edit-taxon-credit" name="edit-taxon-credit" floatingLabel aria-describedby="taxon-credit-help"></paper-input>\n  <span class="help-block" id="taxon-credit-help">This will be displayed as "Taxon information by [your entry]."</span>\n<paper-input label="Taxon Credit Date" id="edit-taxon-credit-date" name="edit-taxon-credit-date" floatingLabel></paper-input>\n'+a+'\n<input type="hidden" name="edit-taxon-author" id="edit-taxon-author" value="" />',
e="<paper-action-dialog backdrop layered autoCloseDisabled closeSelector=\"#close-editor\" id='modal-taxon-edit'>\n  <div id='modal-taxon-editor'>\n    "+d+"\n  </div>\n  <paper-button id='close-editor' dismissive>Cancel</paper-button>\n  <paper-button id='duplicate-taxon' dismissive>Duplicate</paper-button>\n  <paper-button id='save-editor' affirmative>"+b+"</paper-button></paper-action-dialog>",$("#modal-taxon-edit").exists()&&$("#modal-taxon-edit").remove(),$("#search-results").after(e),handleDragDropImage();try{f=$("html /deep/ #edit-notes").get(0),$("html /deep/ #edit-notes-autogrow").attr("target",f)}catch(g){c=g;try{f=$("html >>> #edit-notes").get(0),$("html >>> #edit-notes-autogrow").attr("target",f)}catch(g){c=g;try{f=$("#edit-notes").get(0),$("#edit-notes-autogrow").attr("target",f)}catch(g){c=g,console.error("Couldn't bind autogrow")}}}$("#modal-taxon-edit").unbind();try{return $("html /deep/ #save-editor").unbind(),$("html /deep/ #duplicate-taxon").unbind().click(function(){return createDuplicateTaxon()})}catch(g){return c=g,$("html >>> #save-editor").unbind(),$("html >>> #duplicate-taxon").unbind().click(function(){return createDuplicateTaxon()})}},createNewTaxon=function(){var a,b;animateLoad(),loadModalTaxonEditor("","Create");try{$("html /deep/ #duplicate-taxon").remove()}catch(c){a=c,$("html >>> #duplicate-taxon").remove()}b=isNull($.cookie("ssarherps_fullname"))?$.cookie("ssarherps_user"):$.cookie("ssarherps_fullname");try{$("html /deep/ #edit-taxon-author").attr("value",b)}catch(c){a=c,$("html >>> #edit-taxon-author").attr("value",b)}try{$("html /deep/ #save-editor").click(function(){return saveEditorEntry("new")})}catch(c){a=c,$("html >>> #save-editor").click(function(){return saveEditorEntry("new")})}return $("#modal-taxon-edit")[0].open(),stopLoad()},createDuplicateTaxon=function(){var a;animateLoad();try{try{$("html /deep/ #taxon-id").remove(),$("html /deep/ #last-edited-by").remove(),$("html /deep/ #duplicate-taxon").remove()}catch(b){a=b,$("html >>> #taxon-id").remove(),$("html >>> #last-edited-by").remove(),$("html >>> #duplicate-taxon").remove()}try{$("html /deep/ #save-editor").text("Create").unbind().click(function(){return saveEditorEntry("new")})}catch(b){a=b,$("html >>> #save-editor").text("Create").unbind().click(function(){return saveEditorEntry("new")})}delay(250,function(){return stopLoad()})}catch(b){a=b,stopLoadError("Unable to duplicate taxon"),console.error("Couldn't duplicate taxon! "+a.message);try{$("html /deep/ #modal-taxon-edit").get(0).close()}catch(b){a=b,$("html >>> #modal-taxon-edit").get(0).close()}}return!1},lookupEditorSpecies=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(null==a&&(a=void 0),null==a)return!1;if(animateLoad(),f="<p id=\"last-edited-by\">\n  Last edited by <span id=\"taxon-author-last\" class=\"capitalize\"></span>\n</p>\n<input type='hidden' name='taxon-id' id='taxon-id'/>",loadModalTaxonEditor(f),d$("#save-editor").click(function(){return saveEditorEntry()}),c=d$("#last-edited-by").exists(),c||d$("#axon-credit-help").after(f),h=void 0,g=void 0,b="q="+a,-1!==a.search(/\(/)){for(g={genus:"",species:"",subspecies:""},h={genus:"",species:"",subspecies:""},k=a.split("+"),e=0;e<k.length;){switch(l=k[e],console.log("Checking '"+l+"'"),toInt(e)){case 0:d=l.split("("),console.log("Looking at genus array",d),g.genus=d[0].trim(),h.genus=null!=d[1]?d[1].trim().slice(0,-1):d[0];break;case 1:i=l.split("("),console.log("Looking at species array",i),g.species=i[0].trim(),h.species=null!=i[1]?i[1].trim().slice(0,-1):i[0];break;case 2:j=l.split("("),console.log("Looking at ssp array",j),g.subspecies=j[0].trim(),h.subspecies=null!=j[1]?j[1].trim().slice(0,-1):j[0];break;default:console.error("K value of '"+e+"' didn't match 0,1,2!")}k[e]=l.trim(),e++}a=g.genus+"+"+g.species,isNull(g.subspecies)||(a+=g.subspecies),b="q="+a+"&loose=true",console.warn("Bad name! Calculated out:"),console.warn("Should be currently",h),console.warn("Was previously",g),console.warn("Pinging with",""+uri.urlString+searchParams.targetApi+"?q="+a)}return $.get(searchParams.targetApi,b,"json").done(function(b){var c,d,e,f,i,j,k,l,m,n,o,p,q;try{if(i=b.result[0],null==i)return stopLoadError("Sorry, there was a problem parsing the information for this taxon. If it persists, you may have to fix it manually."),console.error("No data returned for",searchParams.targetApi+"?q="+a),!1;try{i.deprecated_scientific=JSON.parse(i.deprecated_scientific)}catch(r){j=r}null!=g&&(toastStatusMessage("Bad information found. Please review and resave."),i.genus=h.genus,i.species=h.species,i.subspecies=h.subspecies,"object"!=typeof i.deprecated_scientific&&(i.deprecated_scientific=new Object),m=g.species,isNull(g.subspecies)||(m+=" "+g.subspecies),i.deprecated_scientific[g.genus.toTitleCase()+" "+m]="AUTHORITY: YEAR"),o=["parens_auth_genus","parens_auth_species","is_alien"];for(d in i){f=i[d];try{"string"==typeof f&&(f=f.trim())}catch(r){j=r}"id"===d&&$("#taxon-id").attr("value",f),"authority_year"===d?(q=parseTaxonYear(f),$("#edit-gauthyear").attr("value",q.genus),$("#edit-sauthyear").attr("value",q.species)):indexOf.call(o,d)>=0?(e=d.split("_"),"parens"===e[0]?(c=d.split("_").pop(),n="#"+c+"-authority-parens"):n="#"+d.replace(/_/g,"-"),d$(n).polymerChecked(toInt(f).toBool())):"taxon_author"===d?("null"===f||isNull(f)?($("#last-edited-by").remove(),console.warn("Removed #last-edited-by! Didn't have an author provided for column '"+d+"', giving '"+f+"'. It's probably the first edit to this taxon.")):d$("#taxon-author-last").text(f),p=isNull($.cookie("ssarherps_fullname"))?$.cookie("ssarherps_user"):$.cookie("ssarherps_fullname"),d$("#edit-taxon-author").attr("value",p)):(k="#edit-"+d.replace(/_/g,"-"),"deprecated_scientific"===d&&(f=JSON.stringify(f).trim().replace(/\\/g,""),f=f.replace(/{/,""),f=f.replace(/}/,""),'""'===f&&(f="")),"notes"!==d?d$(k).attr("value",f):d$(k).text(f))}try{l=d$("#edit-notes").get(0),d$("#edit-notes-autogrow").get(0).update(l)}catch(r){j=r,console.error("Couldn't update autogrow size. Possibly related to","https://github.com/Polymer/paper-input/issues/182")}return $("#modal-taxon-edit")[0].open(),stopLoad()}catch(r){return j=r,stopLoadError(),toastStatusMessage("Unable to populate the editor for this taxon - "+j.message)}}).fail(function(a,b){return stopLoadError(),toastStatusMessage("There was a server error populating this taxon. Please try again.")}),!1},saveEditorEntry=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;null==a&&(a="save"),p=["genus","species","subspecies","common-name","major-type","major-common-type","major-subtype","minor-type","linnean-order","genus-authority","species-authority","notes","image","image-credit","image-license","taxon-author","taxon-credit","taxon-credit-date"],B=new Object,o=!1;try{$("html /deep/ paper-input /deep/ paper-input-decorator").removeAttr("isinvalid")}catch(J){m=J,$("html >>> paper-input-button >>> paper-input-decorator").removeAttr("isinvalid")}try{F=function(a,b){var c,d,e,f,g,h,i,j,k;if(null==b&&(b=!1),j=b?a:d$(a).val(),f=void 0,g=1707,e=new Date,h=e.getUTCFullYear()+1,d=/^[1-2][07-9]\d{2}$|^[1-2][07-9]\d{2} (\"|')[1-2][07-9]\d{2}\1$/,isNumber(j)&&j>g&&h>j||(d.test(j)?-1===j.search(" ")?f="This must be a valid year between "+g+" and "+h:(k=j.split(" "),g<(i=k[0])&&h>i||(f="The first year must be a valid year between "+g+" and "+h),c=k[1].replace(/(\"|')/g,""),c>g&&h>c||(f="The second year must be a valid year between "+g+" and "+h),j=j.replace(/'/g,'"')):f=-1===j.search(" ")?"This must be a valid year between "+g+" and "+h:"Nonstandard years must be of the form: YYYY 'YYYY', eg, 1801 '1802'"),null!=f){if(o=!0,console.warn(a+" failed its validity checks for "+j+"!"),b)throw Error(f);try{$("html /deep/ "+a+" /deep/ paper-input-decorator").attr("error",f).attr("isinvalid","isinvalid")}catch(l){m=l,$("html >>> "+a+" >>> paper-input-decorator").attr("error",f).attr("isinvalid","isinvalid")}}return j};try{q=F("#edit-gauthyear"),A=F("#edit-sauthyear"),console.log("Escape Completion State:",o)}catch(J){m=J,console.error("Unable to parse authority year! "+m.message),d=""}c=new Object,c[q]=A,d=JSON.stringify(c)}catch(J){m=J,console.error("Failed to JSON parse the authority year - "+m.message),d=""}B.authority_year=d;try{if(i=new Object,k=d$("#edit-deprecated-scientific").val(),isNull(k))l="";else{for(j=k.split('","'),x=0,v=j.length;v>x;x++)t=j[x],s=t.split('":"'),i[s[0].replace(/"/g,"")]=s[1].replace(/"/g,"");console.log("Validating",i);for(E in i){if(e=i[E],f=e.split(":"),console.log("Testing "+e,f),2!==f.length)throw Error("Authority string should have an authority and year seperated by a colon.");if(c=f[0].trim(),G=f[1].trim(),-1!==G.search(","))throw Error("Looks like there may be an extra space, or forgotten \", near '"+G+"'");I=F(G,!0),console.log("Validated",c,I)}if(l=JSON.stringify(i),l.replace(/[{}]/g,"")!==k)throw Error("Badly formatted entry - generated doesn't match read")}}catch(J){m=J,console.error("Failed to parse the deprecated scientifics - "+m.message+". They may be empty."),l="",n=m.message+". Check your formatting!";try{$("html /deep/ #edit-deprecated-scientific /deep/ paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}catch(J){m=J,$("html >>> #edit-deprecated-scientific >>> paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}o=!0,g="There was a problem with your formatting for the deprecated scientifics. Please check it and try again."}return B.deprecated_scientific=l,u=["notes","taxon_credit","image","image_credit","image_license"],y=["common-name","major-type","linnean-order","genus-authority","species-authority"],isNull(d$("#edit-image").val())||(y.push("image-credit"),y.push("image-license")),isNull(d$("#edit-taxon-credit").val())||y.push("taxon-credit-date"),$.each(p,function(a,b){var c,d,e,f,g,h;try{if(g="html /deep/ #edit-"+b,isNull($(g)))throw"Invalid Selector"}catch(i){m=i,g="html >>> #edit-"+b}switch(c=b.replace(/-/g,"_"),h=$(g).val().trim(),indexOf.call(u,c)<0&&(h=h.toLowerCase()),b){case"genus":case"species":case"subspecies":if(n="This required field must have only letters",d="genus"===b||"species"===b?isNull(h):!1,/[^A-Za-z]/m.test(h)||d){try{$("html /deep/ #edit-"+b+" /deep/ paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}catch(i){m=i,$("html >>> #edit-"+b+" >>> paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}o=!0}break;case"common-name":case"major-type":case"linnean-order":case"genus-authority":case"species-authority":if(n="This cannot be empty",isNull(h)){try{$("html /deep/ #edit-"+b+" /deep/ paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}catch(i){m=i,$("html >>> #edit-"+b+" >>> paper-input-decorator").attr("error",n).attr("isinvalid","isinvalid")}o=!0}break;default:if(indexOf.call(y,b)>=0&&(e="#edit-"+b,f="This must not be empty",("#edit-image-credit"===e||"#edit-image-license"===e)&&(f="This cannot be empty if an image is provided"),"#edit-taxon-credit-date"===e&&(f="If you have a taxon credit, it also needs a date"),isNull(h))){try{$("html /deep/ #edit-"+b+" /deep/ paper-input-decorator").attr("error",f).attr("isinvalid","isinvalid")}catch(i){m=i,$("html >>> #edit-"+b+" >>> paper-input-decorator").attr("error",f).attr("isinvalid","isinvalid")}o=!0}}return B[c]=h}),o?(animateLoad(),h=null!=g?g:"Bad characters in entry. Stopping ...",null==g&&(g="There was a problem with your entry. Please correct your entry and try again."),stopLoadError(g),console.error(h),!1):(B.id=d$("#taxon-id").val(),B.parens_auth_genus=d$("#genus-authority-parens").polymerChecked(),B.parens_auth_species=d$("#species-authority-parens").polymerChecked(),B.is_alien=d$("#is-alien").polymerChecked(),"save"!==a||isNumber(B.id)?(C=JSON.stringify(B),z=Base64.encodeURI(C),isNull(C)||isNull(z)?(animateLoad(),stopLoadError("The system was unable to parse this entry for the server. Please see the console for more details."),console.error("Unable to stringify the JSON!."),console.warn("The total save object so far is:",B),console.warn("Got the output string",saveSring),console.warn("Sending b64 string",z),!1):(r=$.cookie("ssarherps_auth"),D=$.cookie("ssarherps_secret"),w=$.cookie("ssarherps_link"),H="hash="+r+"&secret="+D+"&dblink="+w,b="perform="+a+"&"+H+"&data="+z,console.log("Going to save",B),console.log("Using mode '"+a+"'"),animateLoad(),$.post(adminParams.apiTarget,b,"json").done(function(a){if(a.status===!0){if(console.log("Server returned",a),o)return console.error("Warning! The item saved, even though it wasn't supposed to."),!1;try{$("html /deep/ #modal-taxon-edit")[0].close()}catch(c){m=c,$("html >>> #modal-taxon-edit")[0].close()}return isNull($("#admin-search").val())||renderAdminSearchResults(),!1}return stopLoadError(),toastStatusMessage(a.human_error),console.error(a.error),console.warn("Server returned",a),console.warn("We sent",""+uri.urlString+adminParams.apiTarget+"?"+b),!1}).fail(function(a,c){return stopLoadError("Failed to send the data to the server."),console.error("Server error! We sent",""+uri.urlString+adminParams.apiTarget+"?"+b),!1}))):(animateLoad(),stopLoadError("The system was unable to generate a valid taxon ID for this entry. Please see the console for more details."),console.error("Unable to get a valid, numeric taxon id! We got '"+B.id+"'."),console.warn("The total save object so far is:",B),!1))},deleteTaxon=function(a){var b,c,d,e,f;return c=$(".delete-taxon .delete-taxon-button[data-database-id='"+a+"']"),f=c.attr("data-taxon").replace(/\+/g," "),e=f.substr(0,1).toUpperCase()+f.substr(1),c.hasClass("extreme-danger")?null!=window.deleteWatchTimer?(d=Date.now()-window.deleteWatchTimer,console.warn("The taxon was asked to be deleted "+d+"ms after the confirmation was prompted. Rejecting ..."),!1):(animateLoad(),b="perform=delete&id="+a,$.post(adminParams.apiTarget,b,"json").done(function(b){return b.status===!0?(c.parents("tr").remove(),toastStatusMessage(e+" with ID "+a+" has been removed from the database."),stopLoad()):(stopLoadError(),toastStatusMessage(b.human_error),console.error(b.error),console.warn(b)),!1}).fail(function(a,b){return stopLoadError(),toastStatusMessage("Failed to communicate with the server."),!1})):(window.deleteWatchTimer=Date.now(),delay(300,function(){return delete window.deleteWatchTimer}),c.addClass("extreme-danger"),delay(7500,function(){return c.removeClass("extreme-danger")}),toastStatusMessage("Click again to confirm deletion of "+e),!1)},handleDragDropImage=function(a,b){return null==a&&(a="#upload-image"),"function"!=typeof b&&(b=function(a,b){var c,d,e,f,g;if(b.status!==!0)return null==b.human_error&&(b.human_error="There was a problem uploading your image."),toastStatusMessage(b.human_error),console.error("Error uploading!",b),!1;try{e=a.name,ssar.dropzone.disable(),d=e.split(".").pop(),f=md5(e)+"."+d,g="species_photos/"+f,d$("#edit-image").attr("disabled","disabled").attr("value",g),toastStatusMessage("Upload complete")}catch(h){c=h,console.error("There was a problem with upload post-processing - "+c.message),console.warn("Using",e,b),toastStatusMessage("Your upload completed, but we couldn't post-process it.")}return!1}),loadJS("bower_components/JavaScript-MD5/js/md5.min.js"),loadJS("bower_components/dropzone/dist/min/dropzone.min.js",function(){var c,d,e,f,g;return c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href","css/dropzone.min.css"),document.getElementsByTagName("head")[0].appendChild(c),Dropzone.autoDiscover=!1,d="Drop a high-resolution image for the taxon here.",e=function(){return d$(a).css("box-shadow","").css("border",""),d$(a+" .dz-message span").text(d)},f={url:uri.urlString+"meta.php?do=upload_image",acceptedFiles:"image/*",autoProcessQueue:!0,maxFiles:1,dictDefaultMessage:d,init:function(){return this.on("error",function(){return toastStatusMessage("An error occured sending your image to the server.")}),this.on("canceled",function(){return toastStatusMessage("Upload canceled.")}),this.on("dragover",function(){return d$(a+" .dz-message span").text("Drop here to upload the image"),d$(a).css("box-shadow","0px 0px 15px rgba(15,157,88,.8)").css("border","1px solid #0F9D58")}),this.on("dragleave",function(){return e()}),this.on("dragend",function(){return e()}),this.on("drop",function(){return e()}),this.on("success",function(a,c){return b(a,c)})}},d$(a).hasClass("dropzone")||d$(a).addClass("dropzone"),g=new Dropzone(d$(a).get(0),f),ssar.dropzone=g}),!1},$(function(){return $("#next").exists()?$("#next").unbind().click(function(){return openTab(adminParams.adminPageUrl)}):void 0}),function(a){"function"==typeof define&&define.amd?define(a):window.purl=a()}(function(){function a(a,b){for(var c=decodeURI(a),d=p[b?"strict":"loose"].exec(c),e={attr:{},param:{},seg:{}},g=14;g--;)e.attr[n[g]]=d[g]||"";return e.param.query=f(e.attr.query),e.param.fragment=f(e.attr.fragment),e.seg.path=e.attr.path.replace(/^\/+|\/+$/g,"").split("/"),e.seg.fragment=e.attr.fragment.replace(/^\/+|\/+$/g,"").split("/"),e.attr.base=e.attr.host?(e.attr.protocol?e.attr.protocol+"://"+e.attr.host:e.attr.host)+(e.attr.port?":"+e.attr.port:""):"",e}function b(a){var b=a.tagName;return"undefined"!=typeof b?m[b.toLowerCase()]:b}function c(a,b){if(0===a[b].length)return a[b]={};var c={};for(var d in a[b])c[d]=a[b][d];return a[b]=c,c}function d(a,b,e,f){var g=a.shift();if(g){var h=b[e]=b[e]||[];"]"==g?j(h)?""!==f&&h.push(f):"object"==typeof h?h[k(h).length]=f:h=b[e]=[b[e],f]:~g.indexOf("]")?(g=g.substr(0,g.length-1),!q.test(g)&&j(h)&&(h=c(b,e)),d(a,h,g,f)):(!q.test(g)&&j(h)&&(h=c(b,e)),d(a,h,g,f))}else j(b[e])?b[e].push(f):"object"==typeof b[e]?b[e]=f:"undefined"==typeof b[e]?b[e]=f:b[e]=[b[e],f]}function e(a,b,c){if(~b.indexOf("]")){var e=b.split("[");d(e,a,"base",c)}else{if(!q.test(b)&&j(a.base)){var f={};for(var h in a.base)f[h]=a.base[h];a.base=f}""!==b&&g(a.base,b,c)}return a}function f(a){return i(String(a).split(/&|;/),function(a,b){try{b=decodeURIComponent(b.replace(/\+/g," "))}catch(c){}var d=b.indexOf("="),f=h(b),g=b.substr(0,f||d),i=b.substr(f||d,b.length);return i=i.substr(i.indexOf("=")+1,i.length),""===g&&(g=b,i=""),e(a,g,i)},{base:{}}).base}function g(a,b,c){var d=a[b];"undefined"==typeof d?a[b]=c:j(d)?d.push(c):a[b]=[d,c]}function h(a){for(var b,c,d=a.length,e=0;d>e;++e)if(c=a[e],"]"==c&&(b=!1),"["==c&&(b=!0),"="==c&&!b)return e}function i(a,b){for(var c=0,d=a.length>>0,e=arguments[2];d>c;)c in a&&(e=b.call(void 0,e,a[c],c,a)),++c;return e}function j(a){return"[object Array]"===Object.prototype.toString.call(a)}function k(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}function l(b,c){return 1===arguments.length&&b===!0&&(c=!0,b=void 0),c=c||!1,b=b||window.location.toString(),{data:a(b,c),attr:function(a){return a=o[a]||a,"undefined"!=typeof a?this.data.attr[a]:this.data.attr},param:function(a){return"undefined"!=typeof a?this.data.param.query[a]:this.data.param.query},fparam:function(a){return"undefined"!=typeof a?this.data.param.fragment[a]:this.data.param.fragment},segment:function(a){return"undefined"==typeof a?this.data.seg.path:(a=0>a?this.data.seg.path.length+a:a-1,this.data.seg.path[a])},fsegment:function(a){return"undefined"==typeof a?this.data.seg.fragment:(a=0>a?this.data.seg.fragment.length+a:a-1,this.data.seg.fragment[a])}}}var m={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],o={anchor:"fragment"},p={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},q=/^[0-9]+$/;return l.jQuery=function(a){null!=a&&(a.fn.url=function(c){var d="";return this.length&&(d=a(this).attr(b(this[0]))||""),l(d,c)},a.url=l)},l.jQuery(window.jQuery),l});var xmlToJSON=function(){this.version="1.1";var a={mergeCDATA:!0,grokAttr:!0,grokText:!0,normalize:!0,xmlns:!0,namespaceKey:"_ns",textKey:"_text",valueKey:"_value",attrKey:"_attr",cdataKey:"_cdata",attrsAsObject:!0,stripAttrPrefix:!0,stripElemPrefix:!0,childrenAsArray:!0},b=new RegExp(/(?!xmlns)^.*:/),c=new RegExp(/^\s+|\s+$/g);return this.grokType=function(a){return/^\s*$/.test(a)?null:/^(?:true|false)$/i.test(a)?"true"===a.toLowerCase():isFinite(a)?parseFloat(a):a},this.parseString=function(a,b){return this.parseXML(this.stringToXML(a),b)},this.parseXML=function(d,e){for(key in e)a[key]=e[key];var f={},g=0,h="";if(a.xmlns&&d.namespaceURI&&(f[a.namespaceKey]=d.namespaceURI),d.attributes&&d.attributes.length>0){var i={};for(g;g<d.attributes.length;g++)oAttrib=d.attributes.item(g),l={},attribName="",a.stripAttrPrefix?attribName=oAttrib.name.replace(b,""):attribName=oAttrib.name,a.grokAttr?l[a.valueKey]=grokType(oAttrib.value.replace(c,"")):l[a.valueKey]=oAttrib.value.replace(c,""),a.xmlns&&oAttrib.namespaceURI&&(l[a.namespaceKey]=oAttrib.namespaceURI),a.attrsAsObject?i[attribName]=l:f[a.attrKey+attribName]=l;a.attrsAsObject&&(f[a.attrKey]=i)}if(d.hasChildNodes())for(var j,k,l,m=0;m<d.childNodes.length;m++)j=d.childNodes.item(m),4===j.nodeType?a.mergeCDATA?h+=j.nodeValue:f.hasOwnProperty(a.cdataKey)?(f[a.cdataKey].constructor!==Array&&(f[a.cdataKey]=[f[a.cdataKey]]),f[a.cdataKey].push(j.nodeValue)):a.childrenAsArray?(f[a.cdataKey]=[],f[a.cdataKey].push(j.nodeValue)):f[a.cdataKey]=j.nodeValue:3===j.nodeType?h+=j.nodeValue:1===j.nodeType&&(0===g&&(f={}),k=a.stripElemPrefix?j.nodeName.replace(b,""):j.nodeName,l=xmlToJSON.parseXML(j),f.hasOwnProperty(k)?(f[k].constructor!==Array&&(f[k]=[f[k]]),f[k].push(l)):(a.childrenAsArray?(f[k]=[],f[k].push(l)):f[k]=l,g++));else h||(a.childrenAsArray?(f[a.textKey]=[],f[a.textKey].push(null)):f[a.textKey]=null);return h&&(a.grokText?(value=this.grokType(h.replace(c,"")),null!==value&&void 0!==value&&(f[a.textKey]=value)):a.normalize?f[a.textKey]=h.replace(c,"").replace(/\s+/g," "):f[a.textKey]=h.replace(c,"")),f},this.xmlToString=function(a){try{var b=a.xml?a.xml:(new XMLSerializer).serializeToString(a);return b}catch(c){return null}},this.stringToXML=function(a){try{var b=null;if(window.DOMParser){var c=new DOMParser;return b=c.parseFromString(a,"text/xml")}return b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a),b}catch(d){return null}},this}();!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}});
//# sourceMappingURL=maps/combined.map